<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: grid/plugins/Plugin.js</title>

    <script src="scripts/prettify.js"> </script>
    <script src="scripts/lang-css.js"> </script>
    <!--[if lt IE 9]&gt;
      &lt;script src="//html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;
    &lt;![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/default.css">
    <link type="text/css" rel="stylesheet" href="styles/elf-template.css">
</head>

<body>

<div id="main-template" class="elf-template">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Ext from "../../../../node_modules/tr-grid-util/es6/Ext.js";
import Util from "../util/util.js";
import Grid from "../Grid.js"; // eslint-disable-line
import EventDispatcher from "../event/EventDispatcher.js";
import ElementWrapper from "../components/ElementWrapper.js"; // eslint-disable-line


/** Base class for all built-in plugins
* @constructor
* @extends {EventDispatcher}
*/
var Plugin = function () {
	/* throw("Plugin is an abstract Class"); */
};
Ext.inherits(Plugin, EventDispatcher); // Inherits() will replace prototype of the derived object

//#region Public Methods
/**The name must be readonly and unique among all other plugins
* @public
* @return {string}
*/
Plugin.prototype.getName = function () {
	return "Plugin";
};

/** @public
* @param {!Grid} owner
*/
Plugin.prototype.initialize = function (owner) {
	this._host = owner;
};
/**For disposing any resource
* @public
* @param {!Grid} owner
*/
Plugin.prototype.unload = function (owner) {
	this._host = null;
	this.unlistenAll();
};

/** @public
* @param {Event|Element|ElementWrapper} e
* @return {Grid}
*/
Plugin.prototype.getRelativeGrid = function (e) {
	var targetEl;
	if(e.target) { // The Given object is an Event
		targetEl = /** @type{Element} */(e.target);
		var gridAPI = targetEl["api"];
		if(gridAPI &amp;&amp; gridAPI["getCoreGrid"]) {
			return /** @type{Grid} */(gridAPI["getCoreGrid"]());
		}
	} else if(e["getElement"]) { // The Given object is implementing ElementWrapper
		targetEl = e["getElement"]();
	} else if(Util.isElement(e)){ // The Given object is just an element
		targetEl = /** @type{Element} */(e);
	}

	var gridEl = (targetEl) ? Util.closestElement(targetEl, "tr-grid") : null;
	if(gridEl) {
		if(this._host) {
			if(this._host.getElement() === gridEl) {
				return this._host;
			}
		} else {
			var hostLength = this._hosts ? this._hosts.length : 0;
			for (var i = 0; i &lt; hostLength; i++) {
				var host = this._hosts[i];
				if (host.getElement() === gridEl) {
					return host;
				}
			}
		}
	}

	return null;
};
/** Use in case of there is an overlay over the top of the grid (target element cannot be used).
* @public
* @param {number} x
* @param {number} y
* @return {Element}
*/
Plugin.prototype.getGridElementFromPoint = function (x, y) {
	var elem = document.elementFromPoint(x, y);
	var grid = Util.closestElement(elem, "tr-grid");

	// Some elements are over grid element, hide them all by setting the visibility to hidden
	var skipElem = [];
	var skipVisibility = [];
	while (!grid &amp;&amp; elem &amp;&amp; elem.tagName != "HTML") {
		skipElem.push(elem);
		skipVisibility.push(elem.style.visibility);
		elem.style.visibility = "hidden";
		elem = document.elementFromPoint(x, y);

		grid = Util.closestElement(elem, "tr-grid");
	}
	for (var i = 0; i &lt; skipElem.length; i++) {
		skipElem[i].style.visibility = skipVisibility[i];
	}
	return grid;
};

//#endregion Public Methods

//#region Protected Methods
/** @protected
* @ignore
* @return {Array.&lt;string&gt;}
*/
Plugin.prototype._getDataColumnMap = function () {
	if (this._dataMap) { return this._dataMap; }

	if (this._host) {
		return this._host.getDataColumnMap();
	}
	if (this._hosts &amp;&amp; this._hosts[0]) {
		return this._hosts[0].getDataColumnMap();
	}
	return null;
};
/** @protected
 * @ignore
 * @param {number} colIndex
 * @return {string}
 */
Plugin.prototype._getDataColumnName = function (colIndex) {
	var dataMap = this._getDataColumnMap();
	if(dataMap){
		return dataMap[colIndex] || "";
	}
	return "";
};

/** @protected
* @ignore
* @param {Object} e
* @return {boolean}
*/
Plugin.prototype._isNotFirstHost = function(e) {
	if (this._hosts) {
		return e["sender"] !== this._hosts[0];
	}
	return false;
};
/** @protected
* @ignore
* @param {Object} e
*/
Plugin.prototype._onColumnAdded = function (e) {
	if (this._isNotFirstHost(e)) {
		return;
	}
	if (!e["atTheMiddle"]) { return; }
	var colIndex = /** @type{number} */(e["colIndex"]);
	Util.insertArrayItem(this._colData, colIndex, null);
	Util.insertArrayItem(this._dataMap, colIndex, null);
};
/** @protected
* @ignore
* @param {Object} e
*/
Plugin.prototype._onColumnMoved = function (e) {
	if (this._isNotFirstHost(e)) {
		return;
	}
	var from = /** @type{number} */(e["fromColIndex"]);
	var to = /** @type{number} */(e["toColIndex"]);

	Util.moveArrayItem(this._colData, from, to);
	Util.moveArrayItem(this._dataMap, from, to);
};
/** @protected
* @ignore
* @param {Object} e
*/
Plugin.prototype._onColumnRemoved = function (e) {
	if (this._isNotFirstHost(e)) {
		return;
	}
	if (!e["atTheMiddle"]) { return; }
	var colIndex = /** @type{number} */(e["colIndex"]);
	if(this._colData) {
		this._colData.splice(colIndex, 1);
	}
	if(this._dataMap) {
		this._dataMap.splice(colIndex, 1);
	}
};


/** @protected
* @ignore
* @return {number}
 */
Plugin.prototype._getColumnCount = function() {
	var host = this._host || this._hosts[0];
	return (host) ? host.getColumnCount() : 0;
};
/** @protected
* @ignore
* @param {string} pluginName
* @return {*|null}
 */
Plugin.prototype._getPlugin = function(pluginName) {
	var host = this._host || this._hosts[0];
	return (host) ? host.getPlugin(pluginName) : null;
};

/** @protected
* @ignore
* @param {number} scrollVal
*/
Plugin.prototype._scrollDown = function (scrollVal) {
	var host = this._host || this._hosts[0];
	host.scrollDown(scrollVal);
};
/** @protected
* @ignore
* @param {number} rowIndex
*/
Plugin.prototype._scrollToRow = function (rowIndex) {
	var host = this._host || this._hosts[0];
	host.scrollToRow(null, rowIndex);
};
/** @protected
* @ignore
* @param {number} scrollVal
*/
Plugin.prototype._scrollRight = function (scrollVal) {
	if(this._host) {
		this._host.scrollRight(scrollVal);
	} else if(this._hosts) {
		var len = this._hosts.length;
		for(var i = 0; i &lt; len; ++i) {
			var host = this._hosts[i];
			host.scrollRight(scrollVal);
		}
	}
};

//#endregion Protected Methods

//#region Protected Fields
/** @protected
* @ignore
* @type {Grid}
*/
Plugin.prototype._host = null;
/** @protected
* @ignore
* @type {Array.&lt;Grid&gt;}
*/
Plugin.prototype._hosts = null; // For a plug-in that support multi-table

/** @protected
* @ignore
* @type {Array.&lt;string|null&gt;}
*/
Plugin.prototype._dataMap = null;
/** @protected
* @ignore
* @type {Array.&lt;Object&gt;}
*/
Plugin.prototype._colData = null;
//#endregion Protected Fields

Plugin._proto = Plugin.prototype;

export default Plugin;
export { Plugin };
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="ElementFrameWork.html">ElementFrameWork</a></li><li><a href="Util.html">Util</a></li></ul><h3>Classes</h3><ul><li><a href="Cell.html">Cell</a></li><li><a href="CellFloatingPanel.html">CellFloatingPanel</a></li><li><a href="CellSpan.html">CellSpan</a></li><li><a href="CellSpans.html">CellSpans</a></li><li><a href="ColumnStats.html">ColumnStats</a></li><li><a href="Conflator.html">Conflator</a></li><li><a href="DataCache.html">DataCache</a></li><li><a href="DataTable.html">DataTable</a></li><li><a href="DataView.html">DataView</a></li><li><a href="DragAndDropTitlePlugin.html">DragAndDropTitlePlugin</a></li><li><a href="ElementWrapper.html">ElementWrapper</a></li><li><a href="EventDispatcher.html">EventDispatcher</a></li><li><a href="EventListeners.html">EventListeners</a></li><li><a href="Grid.html">Grid</a></li><li><a href="HScrollbar.html">HScrollbar</a></li><li><a href="HttpRequest.html">HttpRequest</a></li><li><a href="LayoutGrid.html">LayoutGrid</a></li><li><a href="PercentBar.html">PercentBar</a></li><li><a href="PercentBarRenderer.html">PercentBarRenderer</a></li><li><a href="Plugin.html">Plugin</a></li><li><a href="RangeBar.html">RangeBar</a></li><li><a href="Reverter.html">Reverter</a></li><li><a href="Scrollbar.html">Scrollbar</a></li><li><a href="SectionSettings.html">SectionSettings</a></li><li><a href="Segment.html">Segment</a></li><li><a href="SegmentCollection.html">SegmentCollection</a></li><li><a href="SortableTitlePlugin.html">SortableTitlePlugin</a></li><li><a href="Virtualizer.html">Virtualizer</a></li><li><a href="VScrollbar.html">VScrollbar</a></li></ul><h3>Interfaces</h3><ul><li><a href="ILayoutGrid.html">ILayoutGrid</a></li></ul><h3>Events</h3><ul><li><a href="DataCache.html#event:dataChanged">dataChanged</a></li><li><a href="DataCache.html#event:dataComposed">dataComposed</a></li><li><a href="DataTable.html#event:dataChanged">dataChanged</a></li><li><a href="DataTable.html#event:dataComposed">dataComposed</a></li><li><a href="DataView.html#event:beforeFiltering">beforeFiltering</a></li><li><a href="DataView.html#event:beforeGroupAdded">beforeGroupAdded</a></li><li><a href="DataView.html#event:dataChanged">dataChanged</a></li><li><a href="DataView.html#event:groupAdded">groupAdded</a></li><li><a href="DataView.html#event:groupCriteriaChanged">groupCriteriaChanged</a></li><li><a href="DataView.html#event:pageCountChanged">pageCountChanged</a></li><li><a href="DataView.html#event:pageIndexChanged">pageIndexChanged</a></li><li><a href="DataView.html#event:preDisposed">preDisposed</a></li><li><a href="DragAndDropTitlePlugin.html#event:columnMoved">columnMoved</a></li><li><a href="DragAndDropTitlePlugin.html#event:dragged">dragged</a></li><li><a href="Grid.html#event:columnAdded">columnAdded</a></li><li><a href="Grid.html#event:columnRemoved">columnRemoved</a></li><li><a href="Grid.html#event:columnVisibilityChanged">columnVisibilityChanged</a></li><li><a href="Grid.html#event:dataSourceChanged">dataSourceChanged</a></li><li><a href="Grid.html#event:postSectionDataBinding">postSectionDataBinding</a></li><li><a href="Grid.html#event:rowExpansionBinding">rowExpansionBinding</a></li><li><a href="Grid.html#event:rowHighlighted">rowHighlighted</a></li><li><a href="Grid.html#event:sectionAdded">sectionAdded</a></li><li><a href="Grid.html#event:widthChanged">widthChanged</a></li><li><a href="HttpRequest.html#event:abort">abort</a></li><li><a href="HttpRequest.html#event:error">error</a></li><li><a href="HttpRequest.html#event:load">load</a></li><li><a href="HttpRequest.html#event:loadend">loadend</a></li><li><a href="HttpRequest.html#event:loadstart">loadstart</a></li><li><a href="HttpRequest.html#event:timeout">timeout</a></li><li><a href="LayoutGrid.html#event:rowCountChanged">rowCountChanged</a></li><li><a href="LayoutGrid.html#event:rowHeightChanged">rowHeightChanged</a></li><li><a href="LayoutGrid.html#event:rowHighlighted">rowHighlighted</a></li><li><a href="SortableTitlePlugin.html#event:clicked">clicked</a></li><li><a href="SortableTitlePlugin.html#event:columnSorted">columnSorted</a></li><li><a href="SortableTitlePlugin.html#event:preClicked">preClicked</a></li><li><a href="SortableTitlePlugin.html#event:preDataSorting">preDataSorting</a></li></ul><h3>Global</h3><ul><li><a href="global.html#get">get</a></li><li><a href="global.html#sortingDef%255B1%255D">sortingDef[1]</a></li></ul>
</nav>


<script src="scripts/linenumber.js"> </script>
<script src="scripts/prettify.js"> </script>
<script> prettyPrint(); </script>
</body>
</html>
