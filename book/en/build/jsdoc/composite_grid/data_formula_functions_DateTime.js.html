<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: data/formula/functions/DateTime.js</title>

    <script src="scripts/prettify.js"> </script>
    <script src="scripts/lang-css.js"> </script>
    <!--[if lt IE 9]&gt;
      &lt;script src="//html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;
    &lt;![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/default.css">
    <link type="text/css" rel="stylesheet" href="styles/elf-template.css">
</head>

<body>

<div id="main-template" class="elf-template">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>goog.provide("tr.fn.DateTime");

goog.require("tr.IntervalSubscription");

goog.require("tr.fn.locale.en");
goog.require("tr.fn.locale.ja");
goog.require("tr.fn.locale.zh");
goog.require("tr.fn.locale.zhHant");
goog.require("tr.fn.locale.ko");
goog.require("tr.fn.locale.ru");
goog.require("tr.fn.locale.de");

/**
 * @ignore
 * @description Convert the time in millisecond of javascript date object to date number since 1 Jan, 1900 (value is 1).
 * @param  {number} millisecond Milliseconds of javascript date object (UTC)
 * @return {number}
 */
tr.fn._getDateNumberSince1900 = function(millisecond) {
	millisecond = +millisecond;
	if(millisecond !== millisecond || millisecond &lt; tr.fn._START_DATE || millisecond === 60) { // Invalid input // 60 is 29 Feb 1900 that is not existing
		return NaN;
	} else {
		var calDate = (millisecond / tr.fn._MILLISECONDS_OF_DAY) + tr.fn._DIFF_DAYS;
		if(millisecond &lt; tr.fn._NEW_PERIOD_DATE) {
			calDate--; // -1 before 1 Mar 1900 because there is not existing 29 Feb 1900 but existing in Window.
		}
		return calDate;
	}
};
/**
 * @ignore
 * @description Convert the javascript date object to the date number since 1 Jan, 1900 (value is 1).
 * @param  {Date} date Javascript date object (locale)
 * @return {number}
 */
tr.fn._getDateNumberFromDate = function(date) {
	return tr.fn._getDateNumberSince1900( Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()) );
};
/**
 * @ignore
 * @description Convert the date number since 1 Jan, 1900 (value is 1) to date fraction or date string.
 * @param  {number} dateNumber Date number since 1 Jan, 1900 (value is 1)
 * @param  {string=} opt_fraction Part of date to retrieve. (year, month or day)
 * @return {number|string}
 */
tr.fn._toDateFraction = function(dateNumber, opt_fraction) {
	dateNumber = +dateNumber;
	if(!dateNumber || dateNumber &lt;= 0 || dateNumber === 60) { // Invalid input // 60 is 29 Feb 1900 that is not existing
		return NaN;
	}
	dateNumber = Math.floor(dateNumber); // Remove the floating point to prevent calculation error

	var date;
	var calDate = dateNumber - tr.fn._DIFF_DAYS;
	if(dateNumber &lt; 60) {
		calDate++; // +1 Before 1 Mar 1900 because there is not existing 29 Feb 1900 but existing in Window.
	}
	date = new Date(calDate * tr.fn._MILLISECONDS_OF_DAY);

	if(opt_fraction === "year") {
		return date.getUTCFullYear();
	} else if(opt_fraction === "month") {
		return date.getUTCMonth() + 1;
	} else if(opt_fraction === "day") {
		return date.getUTCDate();
	} else if(opt_fraction === "dayOfTheWeek") {
		return date.getUTCDay();
	} else {
		var strValue = date.toJSON();
		if(strValue === null) return NaN;		// If data is 'Invalid Date'
		return strValue.substr(0, 10); // Otherwise, return string with date format YYYY-MM-DD UTC
	}
};
/**
 * @ignore
 * @description Convert a supplied hour, minute and second to an time number in range [0,1).
 * @param  {number|string} hour Hour or time text
 * @param  {number=} minute Minute
 * @param  {number=} second Second
 * @return {number}
 */
tr.fn._getTimeNumber = function(hour, minute, second) {
	if(typeof hour === "string") {
		return tr.fn.DateTime["TIMEVALUE"](hour);
	}
	return (hour * tr.fn._AN_HOUR + minute * tr.fn._A_MINUTE + second) / tr.fn._A_DAY;
};
/**
 * @ignore
 * @description Convert the javascript date object to an application time number in range [0,1).
 * @param  {Date} date Javascript date object
 * @return {number}
 */
tr.fn._getTimeNumberFromDate = function(date) {
	return tr.fn._getTimeNumber( date.getHours(), date.getMinutes(), date.getSeconds() );
};
/**
 * @ignore
 * @description Get an hour from the second of one day.
 * @param  {number} second
 * @return {number}
 */
tr.fn._getHourFromSecondOfOneDay = function(second) {
	return Math.floor(second / tr.fn._AN_HOUR) % 24;
};
/**
 * @ignore
 * @description Get a minute from the second of one day.
 * @param  {number} second
 * @return {number}
 */
tr.fn._getMinuteFromSecondOfOneDay = function(second) {
	return Math.floor(second % tr.fn._AN_HOUR / tr.fn._A_MINUTE);
};
/**
 * @ignore
 * @description Get a second from the second of one day.
 * @param  {number} second
 * @return {number}
 */
tr.fn._getSecondFromSecondOfOneDay = function(second) {
	return Math.floor(second % tr.fn._AN_HOUR % tr.fn._A_MINUTE);
};
/**
 * @ignore
 * @description Convert the application time number in range [0,1) to time fraction or time string.
 * @param  {number} timeNumber Application time number
 * @param  {string=} opt_fraction Part of time to retrieve. (hour, minute or second)
 * @return {number|string}
 */
tr.fn._toTimeFraction = function(timeNumber, opt_fraction) {
	var numStr = timeNumber + "";
	timeNumber = +numStr.substr(numStr.indexOf(".")); // Keep only floating point
	if(timeNumber !== timeNumber) {
		return NaN;
	}
	if(timeNumber &gt;= 1 || timeNumber === 0) { // No floating point, it means midnight
		if(opt_fraction) {
			return 0;
		}
		return "00:00:00";
	}

	var secondFromMidnight = Math.round(timeNumber * tr.fn._A_DAY);
	if(opt_fraction === "hour") {
		return tr.fn._getHourFromSecondOfOneDay(secondFromMidnight);
	} else if(opt_fraction === "minute") {
		return tr.fn._getMinuteFromSecondOfOneDay(secondFromMidnight);
	} else if(opt_fraction === "second") {
		return tr.fn._getSecondFromSecondOfOneDay(secondFromMidnight);
	} else {
		var result = "";
		var temp = tr.fn._getHourFromSecondOfOneDay(secondFromMidnight);
		result += (temp &lt; 10) ? "0" + temp : temp; // Hour part
		temp = tr.fn._getMinuteFromSecondOfOneDay(secondFromMidnight);
		result += (temp &lt; 10) ? ":0" + temp : ":" + temp; // Minute part
		temp = tr.fn._getSecondFromSecondOfOneDay(secondFromMidnight);
		result += (temp &lt; 10) ? ":0" + temp : ":" + temp; // Second part

		return result; // Otherwise, return string with time format HH:mm:ss UTC
	}
};
/**
 * @ignore
 * @description Format the Date object to specified format.
 * @param  {Date} date Date object
 * @param  {string} dateTimeFormat Datetime format. Referred to TEXT function.
 * @return {string}
 */
tr.fn._dateFormatter = function(date, dateTimeFormat) {
	var locale = tr.fn.locale[tr.fn._localeSetting] || tr.fn.locale["en"];
	/* Example:
		DD-MM-YYYY &gt;&gt; 22-03-2017
		ddDD-mmMM &gt;&gt; 2222-3503 (lower case and upper case can be next to each others)
		dBBBBB-mCCCC &gt;&gt; 22BBBBB-35CCCC (Any non-convertable will remain the same)
		hh123:ss &gt;&gt; 06123:59 (Any number will remain the same)
		MMMMMYYYYYAAAAA &gt;&gt; March2017AAAAA (There is no default for A/a characters. Any extra character will not be splitted)
	*/
	var result = dateTimeFormat.replace(/D+|M+|Y+|H+|S+|A+|d+|m+|y+|h+|s+|a+|\[[^\]]*\]+/g, function(match) {
		var fchar = (match) ? match.charAt(0) : "";
		if(fchar === "[") { // Static text
			return match.substring(1, match.length - 1);
		}

		var formatter = tr.fn._dateFormat[match];
		if(!formatter) {
			var mod = match;
			if(tr.fn._lowerCaseDateFormat[fchar]) {
				mod = match.toUpperCase();
				fchar = fchar.toUpperCase();
				formatter = tr.fn._dateFormat[mod];
			}
			if(!formatter) {
				mod = fchar + "_";
				formatter = tr.fn._dateFormat[mod];
			}
		}
		if(formatter) {
			return formatter(date, locale);
		}
		return match;
	});

	return result;
};
/**
 * @ignore
 * @description Get the current date &amp; time number. Date number since 1 Jan, 1900 (value is 1) and time in range [0,1).
 * @return {number}
 */
tr.fn._now = function() {
	var now = new Date();
	return tr.fn._getDateNumberFromDate( now ) + tr.fn._getTimeNumberFromDate( now );
};
/**
 * @ignore
 * @description Add zero prefix to the number.
 * @param {number} num
 * @return {string}
 */
tr.fn._prefixZero = function(num) {
	return (num &gt; 9) ? "" + num : "0" + num;
};
/**
 * @ignore
 * @description Set the locale language for localization.
 * @param {string} opt_lang
 */
tr.fn.setLocale = function(opt_lang) {
	opt_lang = opt_lang || "en";
	if (opt_lang.toLowerCase() === 'zh-hant') {
		tr.fn._localeSetting = 'zhHant';
	} else {
		tr.fn._localeSetting = opt_lang.toLowerCase().substr(0, 2);
	}
};
/**
 * @ignore
 * @description Set the default date time format in formula.
 * @param {string} format
 */
tr.fn.setDateTimePattern = function(format) {
	tr.fn._dateTimePattern = format || "M/D/YY h:mm A";
};

/**
 * @namespace DateTime
 * @description
 *    {lang=en} Date/Time manipulation functions
 *    {lang=ja} 日付/時刻 に関する関数
 *    {lang=zh} 日期/时间操作函数
 *    {lang=hant} 日期/時間操作函數
 *    {lang=ko} 날짜/시간 조작 함수
 *    {lang=ru} Date/Time manipulation functions
 *    {lang=de} Datum/Uhrzeit-Manipulationsfunktionen
 */
tr.fn.DateTime = {};

/**
 * @function DATE
 * @memberof DateTime
 * @description
 *    {lang=en} The DATE function converts a supplied year, month and day into an date number since 1 Jan, 1900 (value is 1).
 *    {lang=ja} DATE 関数は、指定された年, 月, 日 を1900年1月1日以降の日付番号に変換します (値 1)。
 *    {lang=zh} DATE 函数将所提供的年、月和日转换成日期值，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=hant} DATE 函數將所提供的年、月和日轉換成日期值，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=ko} DATE 함수는 입력한 연도, 월, 일을 1900년 1월 1일(값 1) 이후의 날짜 숫자로 변환합니다.
 *    {lang=ru} The DATE function converts a supplied year, month and day into an date number since 1 Jan, 1900 (value is 1).
 *    {lang=de} Die Funktion DATE (DATUM) konvertiert ein Jahr, einen Monat und einen Tag in eine numerische Datumsangabe seit dem 1. Jan. 1900 (Wert ist 1).
 * @param  {number|string} year
 *    {lang=en} Year (number of year) or text representing the date
 *    {lang=ja} 日付を表す年 (年数) または文字
 *    {lang=zh} 代表日期的年 (年的数字) 或文本
 *    {lang=hant} 代表日期的年 (年的數字) 或文本
 *    {lang=ko} 연도(연도의 숫자) 또는 날짜를 나타내는 텍스트
 *    {lang=ru} Year (number of year) or text representing the date
 *    {lang=de} Jahr (Anzahl Jahre) oder Text, der das Datum darstellt
 * @param  {number=} month
 *    {lang=en} Month
 *    {lang=ja} 月
 *    {lang=zh} 月
 *    {lang=hant} 月
 *    {lang=ko} 월
 *    {lang=ru} Month
 *    {lang=de} Monat
 * @param  {number=} day
 *    {lang=en} Day
 *    {lang=ja} 日
 *    {lang=zh} 日
 *    {lang=hant} 日
 *    {lang=ko} 일
 *    {lang=ru} Day
 *    {lang=de} Tag
 * @return {number}
 * @example
 *    =DATE(2001,11,5)
 *    =DATE("11/05/2001") Date format should be MM/DD/YYYY
 */
tr.fn.DateTime["DATE"] = function(year, month, day) {
	if(typeof year === "string") {
		return tr.fn.DateTime["DATEVALUE"](year);
	}
	return tr.fn._getDateNumberSince1900( Date.UTC(year, month - 1, day) );
};
/**
 * @function DATEVALUE
 * @memberof DateTime
 * @description
 *    {lang=en} The DATEVALUE function converts a date text into an date number since 1 Jan, 1900 (value is 1). Date format should be MM/DD/YYYY.
 *    {lang=ja} DATEVALUE 関数は、日付文字列を1900年1月1日以降の日付番号に変換します (値 1)。日付形式は、MM/DD/YYYY です。
 *    {lang=zh} DATEVALUE 函数将日期文本转换成日期数字，起始日期为 1900年1月1日 (值是 1)。日期格式是 MM/DD/YYYY。
 *    {lang=hant} DATEVALUE 函數將日期文本轉換成日期數字，起始日期為 1900年1月1日 (值是 1)。日期格式是 MM/DD/YYYY。
 *    {lang=ko} DATEVALUE 함수는 날짜 텍스트를 1900년 1월 1일(값 1) 이후의 날짜 숫자로 변환합니다. 날짜 형식은 MM/DD/YYYY여야 합니다.
 *    {lang=ru} The DATEVALUE function converts a date text into an date number since 1 Jan, 1900 (value is 1). Date format should be MM/DD/YYYY.
 *    {lang=de} Die Funktion DATEVALUE (DATUMSWERT) konvertiert ein Datum in eine numerische Datumsangabe seit dem 1. Jan. 1900 (Wert ist 1). Das Datumsformat sollte MM/DD/YYYY sein.
 * @param  {string|*} dateText
 *    {lang=en} A text string representing a date
 *    {lang=ja} 日付を表す文字
 *    {lang=zh} 代表日期的文本字符串
 *    {lang=hant} 代表日期的文本字符串
 *    {lang=ko} 날짜를 나타내는 텍스트 문자열
 *    {lang=ru} A text string representing a date
 *    {lang=de} Eine Textzeichenfolge, die ein Datum darstellt
 * @return {number}
 * @example
 *    =DATEVALUE("07/05/2001")
 */
tr.fn.DateTime["DATEVALUE"] = function(dateText) {
	if (typeof dateText === "number") { // From IDN data, NOW() or TODAY() must not use this function due to the result is in the same value pattern
		// IDN raw data is UTC+0 timezone
		return tr.fn._getDateNumberSince1900( dateText * 1000 ); // IDN data * 1000 === javascript millisecond
	} else {
		if (typeof dateText !== "string") {
			dateText = dateText + "";
		}
		var temp = new Date(dateText);
		if(dateText.match(/^\d{1,4}(-\d{2}(-\d{2})?)?$/)) { // Assume ISO date format, need to adjust timezone
			return tr.fn._getDateNumberFromDate( new Date(temp.getTime() + temp.getTimezoneOffset() * 60 * 1000) ); // Adjust timezone
		} else { // Not ISO date format, no need to adjust timezone
			return tr.fn._getDateNumberFromDate( temp );
		}
	}
};
/**
 * @function DATETEXT
 * @memberof DateTime
 * @description
 *    {lang=en} The DATETEXT function converts an date number since 1 Jan, 1900 into a text in format YYYY-MM-DD.
 *    {lang=ja} DATETEXT 関数は、1900年1月1日以降の日付番号を YYYY-MM-DD 形式のテキストに変換します。
 *    {lang=zh} DATETEXT 函数将日期数字转换为文本，起始日期是 1900年1月1日，文本格式为 YYYY-MM-DD。
 *    {lang=hant} DATETEXT 函數將日期數字轉換為文本，起始日期是 1900年1月1日，文本格式為 YYYY-MM-DD。
 *    {lang=ko} DATETEXT 함수는 1900년 1월 1일 이후의 날짜 숫자를 YYYY-MM-DD 형식의 텍스트로 변환합니다.
 *    {lang=ru} The DATETEXT function converts an date number since 1 Jan, 1900 into a text in format YYYY-MM-DD.
 *    {lang=de} Die Funktion DATETEXT (DATUMSTEXT) konvertiert eine numerische Datumsangabe seit dem 1. Jan. 1900 in ein Textformat, YYYY-MM-DD.
 * @param  {number} dateNumber
 *    {lang=en} A date number since 1 Jan, 1900
 *    {lang=ja} 1900年1月1日以降の日付番号
 *    {lang=zh} 日期数字的最小值是 1900年1月1日
 *    {lang=hant} 日期數字的最小值是 1900年1月1日
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자
 *    {lang=ru} A date number since 1 Jan, 1900
 *    {lang=de} Ein numerisches Datum seit 1. Jan. 1900
 * @return {string|number}
 * @example
 *    =DATETEXT(38400)
 */
tr.fn.DateTime["DATETEXT"] = function(dateNumber) {
	return /** @type{string|number} */(tr.fn._toDateFraction( dateNumber ));
};
/**
 * @function DAY
 * @memberof DateTime
 * @description
 *    {lang=en} The DAY function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the day.
 *    {lang=ja} DAY 関数は、1900年1月1日以降の日付番号 (値 1) を日付を表す整数に変換します。
 *    {lang=zh} DAY 函数将日期数字转换成代表日的整数，起始日期为 1900年1月1日 (值是 1)。
 *    {lang=hant} DAY 函數將日期數字轉換成代表日的整數，起始日期為 1900年1月1日 (值是 1)。
 *    {lang=ko} DAY 함수는 1900년 1월 1일(값 1) 이후의 날짜 숫자를 해당 일을 나타내는 정수로 변환합니다.
 *    {lang=ru} The DAY function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the day.
 *    {lang=de} Die Funktion DAY (TAG) konvertiert ein numerisches Datum seit dem 1. Jan. 1900 (Wert ist 1) in eine Ganzzahl, die den Tag darstellt.
 * @param  {number} dateNumber
 *    {lang=en} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=ja} 1900年1月1日以降の日付番号 (値 1)
 *    {lang=zh} 日期数字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=hant} 日期數字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자(값 1)
 *    {lang=ru} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=de} Ein numerisches Datum seit 1. Jan. 1900 (Wert ist 1)
 * @return {number}
 * @example
 *    =DAY(37200)
 */
tr.fn.DateTime["DAY"] = function(dateNumber) {
	return /** @type{number} */(tr.fn._toDateFraction( dateNumber, "day" ));
};
/**
 * @function MONTH
 * @memberof DateTime
 * @description
 *    {lang=en} The MONTH function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the month.
 *    {lang=ja} MONTH 関数は、1900年1月1日以降の日付番号 (値 1) を月を表す整数に変換します。
 *    {lang=zh} MONTH 函数将日期数字转换成代表月的整数，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=hant} MONTH 函數將日期數字轉換成代表月的整數，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=ko} MONTH 함수는 1900년 1월 1일(값 1) 이후의 날짜 숫자를 해당 월을 나타내는 정수로 변환합니다.
 *    {lang=ru} The MONTH function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the month.
 *    {lang=de} Die Funktion MONTH (MONAT) konvertiert ein numerisches Datum seit dem 1. Jan. 1900 (Wert ist 1) in eine Ganzzahl, die den Monat darstellt.
 * @param  {number} dateNumber
 *    {lang=en} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=ja} 1900年1月1日以降の日付番号 (値 1)
 *    {lang=zh} 日期数字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=hant} 日期數字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자(값 1)
 *    {lang=ru} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=de} Ein numerisches Datum seit 1. Jan. 1900 (Wert ist 1)
 * @return {number}
 * @example
 *    =MONTH(37200)
 */
tr.fn.DateTime["MONTH"] = function(dateNumber) {
	return /** @type{number} */(tr.fn._toDateFraction( dateNumber, "month" ));
};
/**
 * @function YEAR
 * @memberof DateTime
 * @description
 *    {lang=en} The YEAR function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the year.
 *    {lang=ja} YEAR 関数は、1900年1月1日以降の日付番号 (値 1) を年を表す整数に変換します。
 *    {lang=zh} YEAR 函数将日期数字转换成代表年的整数，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=hant} YEAR 函數將日期數字轉換成代表年的整數，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=ko} YEAR 함수는 1900년 1월 1일(값 1) 이후의 날짜 숫자를 해당 연도를 나타내는 정수로 변환합니다.
 *    {lang=ru} The YEAR function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the year.
 *    {lang=de} Die Funktion YEAR (JAHR) konvertiert ein numerisches Datum seit dem 1. Jan. 1900 (Wert ist 1) in eine Ganzzahl, die das Jahr darstellt.
 * @param  {number} dateNumber
 *    {lang=en} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=ja} 1900年1月1日以降の日付番号 (値 1)
 *    {lang=zh} 日期数字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=hant} 日期數字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자(값 1)
 *    {lang=ru} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=de} Ein numerisches Datum seit 1. Jan. 1900 (Wert ist 1)
 * @return {number}
 * @example
 *    =YEAR(38400)
 */
tr.fn.DateTime["YEAR"] = function(dateNumber) {
	return /** @type{number} */(tr.fn._toDateFraction( dateNumber, "year" ));
};
/**
 * @function WEEKDAY
 * @memberof DateTime
 * @description
 *    {lang=en} The WEEKDAY function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the day of the week.
 *    {lang=ja} The WEEKDAY function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the day of the week.
 *    {lang=zh} WEEKDAY 函数将日期数字转换成代表一周中日的整数，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=hant} WEEKDAY 函數將日期數字轉換成代表一周中日的整數，起始日期是 1900年1月1日 (值是 1)。
 *    {lang=ko} WEEKDAY 함수는 1900년 1월 1일(값 1) 이후의 날짜 숫자를 해당 요일을 나타내는 정수로 변환합니다.
 *    {lang=ru} The WEEKDAY function converts an date number since 1 Jan, 1900 (value is 1) into an integer representing the day of the week.
 *    {lang=de} Die Funktion WEEKDAY (WOCHENTAG) konvertiert ein numerisches Datum seit dem 1. Jan. 1900 (Wert ist 1) in eine Ganzzahl, die den Wochentag darstellt.
 * @param  {number} dateNumber
 *    {lang=en} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=ja} 1900年1月1日以降の日付番号 (値 1)
 *    {lang=zh} 日期数字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=hant} 日期數字，起始日期是 1900年1月1日 (值是 1)
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자(값 1)
 *    {lang=ru} A date number since 1 Jan, 1900 (value is 1)
 *    {lang=de} Ein numerisches Datum seit 1. Jan. 1900 (Wert ist 1)
 * @param  {number=} returnType
 *    {lang=en} Optional. A number that determines the type of return value. Default is 1.
 *    {lang=ja} Optional. A number that determines the type of return value. Default is 1.
 *    {lang=zh} 可选。确定返回值的类型的数字。默认为 1。
 *    {lang=hant} 可選。確定返回值的類型的數字。默認為 1。
 *    {lang=ko} 선택 사항. 반환값의 유형을 결정하는 숫자입니다. 기본값은 1입니다.
 *    {lang=ru} Optional. A number that determines the type of return value. Default is 1.
 *    {lang=de} Optional. Eine Zahl, die den Typ des R・kgabewerts bestimmt. Standard ist 1.
 * @return {number}
 * @example
 *    =WEEKDAY(37200)
 *    =WEEKDAY(TODAY())
 *    =WEEKDAY(DATE(2017,11,22), 11)
 * ---------------------------------------------------------------
 * | Return Type  | First Number Returned | Last Number Returned |
 * ---------------------------------------------------------------
 * | 1 or omitted | 1 (Sunday)            | 7 (Saturday)         |
 * | 2            | 1 (Monday)            | 7 (Sunday)           |
 * | 3            | 0 (Monday)            | 6 (Sunday)           |
 * | 11           | 1 (Monday)            | 7 (Sunday)           |
 * | 12           | 1 (Tuesday)           | 7 (Monday)           |
 * | 13           | 1 (Wednesday)         | 7 (Tuesday)          |
 * | 14           | 1 (Thursday)          | 7 (Wednesday)        |
 * | 15           | 1 (Friday)            | 7 (Thursday)         |
 * | 16           | 1 (Saturday)          | 7 (Friday)           |
 * | 17           | 1 (Sunday)            | 7 (Saturday)         |
 * ---------------------------------------------------------------
 */
tr.fn.DateTime["WEEKDAY"] = function(dateNumber, returnType) {
	var val = /** @type{number} */(tr.fn._toDateFraction( dateNumber, "dayOfTheWeek" ));
	if(val === val) { // Valid number
		var adjustValue = true;
		switch(returnType) {
			case 2:
			case 11:
				val = (val === 0) ? 7 : val;
				adjustValue = false;
				break;
			case 3:
				val = (val + 6) % 7;
				adjustValue = false;
				break;
			case 12:
				val += 6;
				break;
			case 13:
				val += 5;
				break;
			case 14:
				val += 4;
				break;
			case 15:
				val += 3;
				break;
			case 16:
				val += 2;
				break;
			default: // 1, 17, omitted
				val += 1;
				adjustValue = false;
				break;
		}
		if(adjustValue) {
			val = (val &gt; 7) ? val - 7 : val;
		}
	}
	return val;
};
/**
 * @function DAYS
 * @memberof DateTime
 * @description
 *    {lang=en} The DAYS function converts a date text into an date number since 1 Jan, 1900 (value is 1). Date format should be MM/DD/YYYY. Equivalent to DATEVALUE function.
 *    {lang=ja} DAYS 関数は、日付文字列を1900年1月1日以降の日付番号に変換します (値 1)。日付形式は、MM/DD/YYYY です。DATEVALUE 関数と同等。
 *    {lang=zh} DAYS 函数将日期文本转换成日期数字，起始日期是 1900年1月1日 (值是 1)。日期格式应为 MM/DD/YYYY。 等同于 DATEVALUE 函数。
 *    {lang=hant} DAYS 函數將日期文本轉換成日期數字，起始日期是 1900年1月1日 (值是 1)。日期格式應為 MM/DD/YYYY。等同於 DATEVALUE 函數。
 *    {lang=ko} DAYS 함수는 날짜 텍스트를 1900년 1월 1일(값 1) 이후의 날짜 숫자로 변환합니다. 날짜 형식은 MM/DD/YYYY여야 합니다. DATEVALUE 함수와 동일합니다.
 *    {lang=ru} The DAYS function converts a date text into an date number since 1 Jan, 1900 (value is 1). Date format should be MM/DD/YYYY. Equivalent to DATEVALUE function.
 *    {lang=de} Die Funktion DAYS (TAGE) konvertiert einen Datumstext in eine numerische Datumsangabe seit dem 1. Jan. 1900 (Wert 1). Das Datumsformat sollte MM/DD/YYYY sein. Entspricht der DATEVALUE (DATUMSWERT)-Funktion.
 * @param  {string} dateText
 *    {lang=en} A text string representing a date
 *    {lang=ja} 日付を表す文字
 *    {lang=zh} 代表日期的文本字符串
 *    {lang=hant} 代表日期的文本字符串
 *    {lang=ko} 날짜를 나타내는 텍스트 문자열
 *    {lang=ru} A text string representing a date
 *    {lang=de} Eine Textzeichenfolge, die ein Datum darstellt
 * @return {number}
 * @example
 *    =DAYS("MM/DD/YYYY")
 */
tr.fn.DateTime["DAYS"] = tr.fn.DateTime["DATEVALUE"];
/**
 * @function TIME
 * @memberof DateTime
 * @description
 *    {lang=en} The TIME function converts a supplied hour, minute and second to time number in range [0,1).
 *    {lang=ja} TIME 関数は、指定された時, 分, 秒を範囲 [0,1) 時刻に変換します。
 *    {lang=zh} TIME 函数将所提供的小时、分钟与秒钟转换成时间数字，范围是 [0,1)。
 *    {lang=hant} TIME 函數將所提供的小時、分鐘與秒鐘轉換成時間數字，範圍是 [0,1)。
 *    {lang=ko} TIME 함수는 입력한 시간, 분 및 초를 [0,1) 범위의 시간 숫자로 변환합니다.
 *    {lang=ru} The TIME function converts a supplied hour, minute and second to time number in range [0,1).
 *    {lang=de} Die Funktion TIME (UHRZEIT) konvertiert eine bereitgestellte Stunden-, Minuten- und Sekundenzahl in eine numerische Zeitangabe im Bereich [0,1].
 * @param  {number|string} hour
 *    {lang=en} Hour (number of hour) or text repesenting the time
 *    {lang=ja} 時刻を表す時間 (時間数) または文字
 *    {lang=zh} 代表时间的小时 (小时数字) 或文本
 *    {lang=hant} 代表時間的小時 (小時數字) 或文本
 *    {lang=ko} 시(시간 숫자) 또는 시간을 나타내는 텍스트
 *    {lang=ru} Hour (number of hour) or text repesenting the time
 *    {lang=de} Stunde (Stundenzahl) oder Text, der die Zeit wiedergibt
 * @param  {number=} minute
 *    {lang=en} Minute
 *    {lang=ja} 分
 *    {lang=zh} 分钟
 *    {lang=hant} 分鐘
 *    {lang=ko} 분
 *    {lang=ru} Minute
 *    {lang=de} Minute
 * @param  {number=} second
 *    {lang=en} Second
 *    {lang=ja} 秒
 *    {lang=zh} 秒钟
 *    {lang=hant} 秒鐘
 *    {lang=ko} 초
 *    {lang=ru} Second
 *    {lang=de} Sekunde
 * @return {number}
 * @example
 *    =TIME(10,25,30)
 *    =TIME("10:25:30") Time format should be HH:mm:ss
 */
tr.fn.DateTime["TIME"] = tr.fn._getTimeNumber;
/**
 * @function TIMEVALUE
 * @memberof DateTime
 * @description
 *    {lang=en} The TIMEVALUE function converts a text representation of a time, into an time number in range [0,1).
 *    {lang=ja} TIMEVALUE 関数は、 時間の文字列形式を範囲 [0,1) 時刻表示形式に変換します。
 *    {lang=zh} TIMEVALUE 函数将代表时间的文本转换成时间数字，范围是 [0,1)。
 *    {lang=hant} TIMEVALUE 函數將代表時間的文本轉換成時間數字，範圍是 [0,1)。
 *    {lang=ko} TIMEVALUE 함수는 시간의 텍스트 표현을 범위 [0,1)의 시간 숫자로 변환합니다.
 *    {lang=ru} The TIMEVALUE function converts a text representation of a time, into an time number in range [0,1).
 *    {lang=de} Die Funktion TIMEVALUE (UHRZEITWERT) konvertiert eine Textdarstellung einer Zeit in eine numerische Zeitangabe im Bereich [0,1).
 * @param  {string} timeText
 *    {lang=en} A text string representing a time.
 *    {lang=ja} 時刻を表す文字
 *    {lang=zh} 代表时间的文本字符串。
 *    {lang=hant} 代表時間的文本字符串。
 *    {lang=ko} 시간을 나타내는 텍스트 문자열.
 *    {lang=ru} A text string representing a time.
 *    {lang=de} Eine Textzeichenfolge, die eine Zeit darstellt
 * @return {number}
 * @example
 *    =TIMEVALUE("14:30:50")
 */
tr.fn.DateTime["TIMEVALUE"] = function(timeText) {
	return tr.fn._getTimeNumberFromDate( new Date("1/1/1970 " + timeText) ); // Return local timezone time number
};
/**
 * @function TIMETEXT
 * @memberof DateTime
 * @description
 *    {lang=en} The TIMETEXT function converts an time number in range [0,1) into a text in format HH:mm:ss.
 *    {lang=ja} TIMETEXT 関数は、範囲 [0,1) の時刻を HH:mm:ss 形式の文字に変換します。
 *    {lang=zh} TIMETEXT 函数将范围是 [0,1) 的时间数字转换成文本，格式是 HH:mm:ss。
 *    {lang=hant} TIMETEXT 函數將範圍是 [0,1) 的時間數字轉換成文本，格式是 HH:mm:ss。
 *    {lang=ko} TIMETEXT 함수는 범위 [0,1)의 시간 숫자를 HH:mm:ss 형식의 텍스트로 변환합니다.
 *    {lang=ru} The TIMETEXT function converts an time number in range [0,1) into a text in format HH:mm:ss.
 *    {lang=de} Die Funktion TIMETEXT (UHRZEITTEXT) konvertiert eine numerische Zeitangabe im Bereich [0,1) in einen Text im Format HH:mm:ss.
 * @param  {number} timeNumber
 *    {lang=en} A time number in range [0,1)
 *    {lang=ja} 範囲 [0,1) の時刻
 *    {lang=zh} 时间数字的范围是 [0,1)
 *    {lang=hant} 時間數字的範圍是 [0,1)
 *    {lang=ko} 범위 [0,1)의 시간 숫자
 *    {lang=ru} A time number in range [0,1)
 *    {lang=de} Eine numerische Zeitangabe im Bereich [0,1)
 * @return {string|number}
 * @example
 *    =TIMETEXT(0.604745)
 */
tr.fn.DateTime["TIMETEXT"] = function(timeNumber) {
	return /** @type{string|number} */(tr.fn._toTimeFraction( timeNumber ));
};
/**
 * @function HOUR
 * @memberof DateTime
 * @description
 *    {lang=en} The HOUR function converts an time number in range [0,1) into an integer representing the hour.
 *    {lang=ja} HOUR 関数は、範囲 [0,1) の時刻を時間を表す整数に変換します。
 *    {lang=zh} HOUR 函数将范围是 [0,1) 的时间数字转换成代表小时的整数。
 *    {lang=hant} HOUR 函數將範圍是 [0,1) 的時間數字轉換成代表小時的整數。
 *    {lang=ko} HOUR 함수는 범위 [0,1)의 시간 숫자를 시간을 나타내는 정수로 변환합니다.
 *    {lang=ru} The HOUR function converts an time number in range [0,1) into an integer representing the hour.
 *    {lang=de} Die Funktion HOUR (STUNDE) konvertiert eine numerische Zeitangabe im Bereich [0,1) in eine Ganzzahl, die die Stunde darstellt.
 * @param  {number} timeNumber
 *    {lang=en} Time number in range [0,1)
 *    {lang=ja} 範囲 [0,1) の時刻
 *    {lang=zh} 时间数字的范围是 [0,1)
 *    {lang=hant} 時間數字的範圍是 [0,1)
 *    {lang=ko} 범위 [0,1)의 시간 숫자
 *    {lang=ru} Time number in range [0,1)
 *    {lang=de} Numerische Zeitangabe im Bereich [0,1)
 * @return {number}
 *    {lang=en} The hour (0-23) according to local time.
 *    {lang=ja} ローカル時間による時間 (0-23)
 *    {lang=zh} 根据当地时间的小时 (0-23)。
 *    {lang=hant} 根據當地時間的小時 (0-23)。
 *    {lang=ko} 현지 시간에 따른 시간(0~23).
 *    {lang=ru} The hour (0-23) according to local time.
 *    {lang=de} Die Stunde (0-23) nach Ortszeit.
 * @example
 *    =HOUR(0.604745)
 */
tr.fn.DateTime["HOUR"] = function(timeNumber) {
	return /** @type{number} */(tr.fn._toTimeFraction( timeNumber, "hour" ));
};
/**
 * @function MINUTE
 * @memberof DateTime
 * @description
 *    {lang=en} The MINUTE function converts an time number in range [0,1) into an integer representing the minute.
 *    {lang=ja} MINUTE 関数は、範囲 [0,1) の時刻を分を表す整数に変換します。
 *    {lang=zh} MINUTE 函数将范围是 [0,1) 的时间数字转换成代表分钟的整数。
 *    {lang=hant} MINUTE 函數將範圍是 [0,1) 的時間數字轉換成代表分鐘的整數。
 *    {lang=ko} MINUTE 함수는 범위 [0,1)의 시간 숫자를 분을 나타내는 정수로 변환합니다.
 *    {lang=ru} The MINUTE function converts an time number in range [0,1) into an integer representing the minute.
 *    {lang=de} Die Funktion MINUTE (MINUTE) konvertiert eine numerische Zeitangabe im Bereich [0,1) in eine Ganzzahl, die die Minute darstellt.
 * @param  {number} timeNumber
 *    {lang=en} Time number in range [0,1)
 *    {lang=ja} 範囲 [0,1) の時刻
 *    {lang=zh} 时间数字的范围是 [0,1)
 *    {lang=hant} 時間數字的範圍是 [0,1)
 *    {lang=ko} 범위 [0,1)의 시간 숫자
 *    {lang=ru} Time number in range [0,1)
 *    {lang=de} Numerische Zeitangabe im Bereich [0,1)
 * @return {number}
 *    {lang=en} The minute (0-59) according to local time.
 *    {lang=ja} ローカル時間による分 (0-59)
 *    {lang=zh} 根据当地时间的分钟 (0-59)。
 *    {lang=hant} 根據當地時間的分鐘 (0-59)。
 *    {lang=ko} 현지 시간에 따른 분(0~59).
 *    {lang=ru} The minute (0-59) according to local time.
 *    {lang=de} Die Minute (0-59) nach Ortszeit.
 * @example
 *    =MINUTE(0.604745)
 */
tr.fn.DateTime["MINUTE"] = function(timeNumber) {
	return /** @type{number} */(tr.fn._toTimeFraction( timeNumber, "minute" ));
};
/**
 * @function SECOND
 * @memberof DateTime
 * @description
 *    {lang=en} The SECOND function converts an time number in range [0,1) into an integer representing the second.
 *    {lang=ja} SECOND 関数は、範囲 [0,1) の時刻を秒を表す整数に変換します。
 *    {lang=zh} SECOND 函数将范围是 [0,1) 的时间数字转换成代表秒钟的整数。
 *    {lang=hant} SECOND 函數將範圍是 [0,1) 的時間數字轉換成代表秒鐘的整數。
 *    {lang=ko} SECOND 함수는 범위 [0,1)의 시간 숫자를 초를 나타내는 정수로 변환합니다.
 *    {lang=ru} The SECOND function converts an time number in range [0,1) into an integer representing the second.
 *    {lang=de} Die Funktion SECOND (SEKUNDE) konvertiert eine numerische Zeitangabe im Bereich [0,1) in eine Ganzzahl, die die Sekunde darstellt.
 * @param  {number} timeNumber
 *    {lang=en} Time number in range [0,1)
 *    {lang=ja} 範囲 [0,1) の時刻
 *    {lang=zh} 时间数字的范围是 [0,1)
 *    {lang=hant} 時間數字的範圍是 [0,1)
 *    {lang=ko} 범위 [0,1)의 시간 숫자
 *    {lang=ru} Time number in range [0,1)
 *    {lang=de} Numerische Zeitangabe im Bereich [0,1)
 * @return {number}
 *    {lang=en} The second (0-59) according to local time.
 *    {lang=ja} ローカル タイムによる秒 (0-59) 。
 *    {lang=zh} 根据当地时间的秒钟 (0-59)。
 *    {lang=hant} 根據當地時間的秒鐘 (0-59)。
 *    {lang=ko} 현지 시간에 따른 초(0~59).
 *    {lang=ru} The second (0-59) according to local time.
 *    {lang=de} Die Sekunde (0-59) nach Ortszeit.
 * @example
 *    =SECOND(0.604745)
 */
tr.fn.DateTime["SECOND"] = function(timeNumber) {
	return /** @type{number} */(tr.fn._toTimeFraction( timeNumber, "second" ));
};
/**
 * @function TEXT
 * @memberof DateTime
 * @description
 *    {lang=en} The TEXT function converts an date &amp; time number since 1 Jan, 1900 into a text in customizable format. Default is YYYY-MM-DD HH:mm:ss.
 *    {lang=ja} TEXT 関数は、1900年1月1日以降の日付 &amp; 時刻をカスタマイズ可能な形式の文字列に変換します。初期設定は、YYYY-MM-DD HH:mm:ss です。
 *    {lang=zh} TEXT 函数将起始日期为 1900年1月1日的日期与时间数字转换成自定义格式的文本。默认是 YYYY-MM-DD HH:mm:ss。
 *    {lang=hant} TEXT 函數將起始日期為 1900年1月1日的日期與時間數字轉換成自定義格式的文本。默認是 YYYY-MM-DD HH:mm:ss。
 *    {lang=ko} TEXT 함수는 1900년 1월 1일 이후의 날짜 및 시간 숫자를 사용자 지정 가능 형식의 텍스트로 변환합니다. 기본값은 YYYY-MM-DD HH:mm:ss입니다.
 *    {lang=ru} The TEXT function converts an date &amp; time number since 1 Jan, 1900 into a text in customizable format. Default is YYYY-MM-DD HH:mm:ss.
 *    {lang=de} Die Funktion TEXT (TEXT) konvertiert eine numerische Datums- und Zeitangabe seit dem 1. Jan. 1900 in ein anpassbares Textformat. Standard ist YYYY-MM-DD HH:mm:ss.
 * @param  {number|string|Date} dateTimeNumber
 *    {lang=en} A date &amp; time number since 1 Jan, 1900 or date &amp; time text in format YYYY-MM-DDTHH:mm:ss
 *    {lang=ja} 1900年1月1日以降の日付 &amp; 時刻または YYYY-MM-DDTHH:mm:ss 形式の日付 &amp; 時刻文字列
 *    {lang=zh} 日期与时间数字，起始日期是 1900年1月1日，或者日期与时间文本，格式是 YYYY-MM-DDTHH:mm:ss
 *    {lang=hant} 日期與時間數字，起始日期是 1900年1月1日，或者日期與時間文本，格式是 YYYY-MM-DDTHH:mm:ss
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 및 시간 숫자 또는 YYYY-MM-DDTHH:mm:ss 형식의 날짜 및 시간 텍스트
 *    {lang=ru} A date &amp; time number since 1 Jan, 1900 or date &amp; time text in format YYYY-MM-DDTHH:mm:ss
 *    {lang=de} Eine numerische Datums- und Zeitangabe seit dem 1. Jan. 1900 oder ein Datums- und Zeittext im Format YYYY-MM-DDTHH:mm:ss
 * @param  {string} dateTimeFormat
 *    {lang=en} A customized format of the result. Default format is M/D/YY h:mm A.
 *    {lang=ja} カスタマイズされた形式。初期設定の形式は、M/D/YY h:mm A です。
 *    {lang=zh} 自定义格式的结果。默认格式是 M/D/YY h:mm A。
 *    {lang=hant} 自定義格式的結果。默認格式是 M/D/YY h:mm A。
 *    {lang=ko} 결과의 사용자 지정 형식. 기본 형식은 M/D/YY h:mm A입니다.
 *    {lang=ru} A customized format of the result. Default format is M/D/YY h:mm A.
 *    {lang=de} Ein benutzerdefiniertes Format des Ergebnisses. Das Standardformat ist M/D/YY h:mm A.
 * @param  {string=} timezone
 *    {lang=en} GMT (Greenwich Mean Time) or LOCAL (Local timezone). Default is GMT.
 *    {lang=ja} GMT (グリニッジ標準時刻) まはたローカル (現地時間帯)。初期設定は。GMT です。
 *    {lang=zh} GMT (格林尼治平均时间) 或 LOCAL (当地时区)。默认是 GMT。
 *    {lang=hant} GMT (格林尼治平均時間) 或 LOCAL (當地時區)。默認是 GMT。
 *    {lang=ko} GMT(그리니치 표준시) 또는 LOCAL(현지 표준시). 기본값은 GMT입니다.
 *    {lang=ru} GMT (Greenwich Mean Time) or LOCAL (Local timezone). Default is GMT.
 *    {lang=de} GMT (Greenwich Mean Time) oder LOCAL (ORTSZEIT) (Lokale Zeitzone). GMT ist Standard.
 * @return {*}
 * @example
 * =TEXT(TODAY(),"DDMMYY")                                // 230317
 * =TEXT(42817.545980)                                    // 3/23/17 6:06 AM // Greenwich timezone (GMT+0)
 * =TEXT(42817.545980, "")                                // 3/23/17 6:06 AM
 * =TEXT(42817.545980, "", "GMT")                         // 3/23/17 6:06 AM
 * =TEXT(42817.545980, "", "LOCAL") // 3/23/17 1:06 PM    // Bangkok timezone (GMT+7)
 * =TEXT(42817.545980, "DDDD D MMMM, YYYY")               // Thursday 23 March, 2017
 * =TEXT(42817.545980, "HH.mm.ss")                        // 06.06.13
 * =TEXT(42817.545980, "HH.mm.ss", "LOCAL")               // 13.06.13
 * =TEXT(42817.545980, "h.mm.ss A")                       // 6.06.13 AM
 * =TEXT(42817.545980, "hh.mm.ss a")                      // 06.06.13 am // Greenwich timezone (GMT+0)
 * =TEXT(42817.545980, "hh.mm.ss a", "LOCAL")             // 01.06.13 pm // Bangkok timezone (GMT+7)
 * =TEXT(42817.545980, "[Date:] YYYYMMDD [Time:] HHmmss") // Date: 20170323 Time: 060613 // Static text should be in [...]
 * -----------------------------------------------------------------------------------------------------------------------------
 * | Group  | Character   | English Output                         | Japanese Output             | Chinese Output              |
 * -----------------------------------------------------------------------------------------------------------------------------
 * | Year   | YY / yy     | 00 01 ... 16 17                        | 00 01 ... 16 17             | 00 01 ... 16 17             |
 * |        | YYYY / yyyy | 2000 2001 ... 2016 2017                | 2000 2001 ... 2016 2017     | 2000 2001 ... 2016 2017     |
 * | Month  | M           | 1 2 ... 11 12                          | 1 2 ... 11 12               | 1 2 ... 11 12               |
 * |        | MM          | 01 02 ... 11 12                        | 01 02 ... 11 12             | 01 02 ... 11 12             |
 * |        | MMM         | Jan Feb ... Nov Dec                    | 1月 2月 ... 11月 12月		 | 1月 2月 ... 11月 12月	       |
 * |        | MMMM        | January February ... November December | 1月 2月 ... 11月 12月		 | 一月 二月 ... 十一月 十二月   |
 * | Day    | D / d       | 1 2 ... 30 31                          | 1 2 ... 30 31               | 1 2 ... 30 31               |
 * |        | DD / dd     | 01 02 ... 30 31                        | 01 02 ... 30 31             | 01 02 ... 30 31             |
 * |        | DDD / ddd   | Sun Mon ... Fri Sat                    | 日 月 ... 金 土				 | 周日 周一 ... 周五 周六	   |
 * |        | DDDD / dddd | Sunday Monday ... Friday Saturday      | 日曜日 月曜日 ... 金曜日 土曜日|星期日 星期一 ... 星期五 星期六|
 * | Hour   | H           | 0 1 ... 22 23                          | 0 1 ... 22 23               | 0 1 ... 22 23               |
 * |        | HH          | 00 01 ... 22 23                        | 00 01 ... 22 23             | 00 01 ... 22 23             |
 * |        | h           | 1 2 ... 11 12                          | 1 2 ... 11 12               | 1 2 ... 11 12               |
 * |        | hh          | 01 02 ... 11 12                        | 01 02 ... 11 12             | 01 02 ... 11 12             |
 * | Minute | m           | 0 1 ... 58 59                          | 0 1 ... 58 59               | 0 1 ... 58 59               |
 * |        | mm          | 00 01 ... 58 59                        | 00 01 ... 58 59             | 00 01 ... 58 59             |
 * | Second | s           | 0 1 ... 58 59                          | 0 1 ... 58 59               | 0 1 ... 58 59               |
 * |        | ss          | 00 01 ... 58 59                        | 00 01 ... 58 59             | 00 01 ... 58 59             |
 * | AM/PM  | A           | AM PM                                  | 午前 午後					 | 上午 下午					   |
 * |        | a           | am pm                                  | 午前 午後					 | 上午 下午					   |
 * -----------------------------------------------------------------------------------------------------------------------------
 */
tr.fn.DateTime["TEXT"] = function(dateTimeNumber, dateTimeFormat, timezone) {
	var date = null;
	var dtTxt; // new Date() is on par with Date.parse in term of performance.
	var localTime = !!(timezone &amp;&amp; timezone.toUpperCase() === "LOCAL");
	if(typeof dateTimeNumber === "number") {
		if(dateTimeNumber &gt; 1e8) { // Maximum date is 100 millions and any number greater than that is assumed to be millisecond
			date = new Date(dateTimeNumber);
		} else { // The given number is assumed to be in Excel format (i.e. integer represents date and fraction represents time)
			// This number is a product of other formulas (e.g. TODAY(), NOW()), which are all local time.
			var dateTxt = tr.fn._toDateFraction( dateTimeNumber );
			if(typeof dateTxt === "string") {
				var timeTxt = tr.fn._toTimeFraction( dateTimeNumber );
				if(typeof timeTxt === "string") {
					dtTxt = dateTxt + " " + timeTxt;
					date = new Date( dtTxt.replace(/\-/g, "\/") ); // Convert YYYY/MM/DD HH:mm:ss
				}
			}
			localTime = true; // Assume that the given date is already in local time
		}
	} else if(dateTimeNumber instanceof Date) {
		// Monitor timestamp should pass the value as Date object
		// IDN data should pass the value as Date object. E.g. CF_DATE, CF_TIME
		date = new Date(dateTimeNumber); // Do not use the passing object
	} else {
		// Pass the value with string format, expected to be ISO8601 format (YYYY-MM-DDTHH:mm:ss)
		dtTxt = dateTimeNumber + "";
		var isISO8601 = dtTxt.match(/^\d{4}(-\d{2}(-\d{2}(T\d{2}\:\d{2}\:\d{2})?)?)?$/);
		dtTxt = dtTxt.replace(/\-/g, "\/"); // Convert to YYYY/MM/DD HH:mm:ss (common for all browsers)
		if(isISO8601) {
			dtTxt = dtTxt.replace(/T/g, " "); // Convert to YYYY/MM/DD HH:mm:ss (common for all browsers)
        }

		date = new Date(dtTxt);
	}

	var millisecs = (date) ? date.getTime() : NaN;
	if(millisecs !== millisecs) { // Invalid date
		return dateTimeNumber || ""; // TODO: Check if we need to convert the original object to string
	}

	// Convert non-local time (GMT) to local time
	if(!localTime) {
		date.setTime(millisecs + date.getTimezoneOffset() * 60000);
	}

	if(!dateTimeFormat) {
		dateTimeFormat = tr.fn._dateTimePattern;
	}

	return tr.fn._dateFormatter(date, dateTimeFormat);
};
/**
 * @function NOW
 * @this {tr.fn.Formula} // NOW method is an extension to tr.fn.Formula object. this.getIntervalService and this.setIntervalService are all methods from tr.fn.Formula object and access the same states from the same object (tr.fn.Formula).
 * @memberof DateTime
 * @description
 *    {lang=en} The NOW function retrieves the current date and time number. Date number since 1 Jan, 1900 and time number in range [0,1). It will update every 15 seconds.
 *    {lang=ja} NOW 関数は、現在の日付 &amp; 時刻を返します。範囲 [0,1) の1900年1月1日以降の日付または時刻。15 秒毎に更新します。
 *    {lang=zh} NOW 函数获取当前日期与时间数字。起始日期数字是 1900年1月1日，时间数字的范围是 [0,1)。每 15 秒钟更新一次。
 *    {lang=hant} NOW 函數獲取當前日期與時間數字。起始日期數字是 1900年1月1日，時間數字的範圍是 [0,1)。每 15 秒鐘更新一次。
 *    {lang=ko} NOW 함수는 현재 날짜 및 시간 숫자를 검색합니다. 1900년 1월 1일 이후의 날짜 숫자와 범위 [0,1)의 시간 숫자. 15초마다 업데이트합니다.
 *    {lang=ru} The NOW function retrieves the current date and time number. Date number since 1 Jan, 1900 and time number in range [0,1). It will update every 15 seconds.
 *    {lang=de} Die Funktion NOW (JETZT) ruft das aktuelle Datum und die aktuelle Uhrzeit ab. Das Datum seit 1. Jan. 1900 und die Uhrzeit im Bereich [0,1). Sie wird alle 15 Sekunden aktualisiert.
 * @return {?number}
 *    {lang=en} Date number since 1 Jan, 1900 and time number in range [0,1).
 *    {lang=ja} 範囲 [0,1) の1900年1月1日以降の日付または時刻。
 *    {lang=zh} 起始日期数字是 1900年1月1日，时间数字的范围是 [0,1)。
 *    {lang=hant} 起始日期數字是 1900年1月1日，時間數字的範圍是 [0,1)。
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자와 범위 [0,1)의 시간 숫자.
 *    {lang=ru} Date number since 1 Jan, 1900 and time number in range [0,1).
 *    {lang=de} Das Datum seit 1. Jan. 1900 und die Uhrzeit im Bereich [0,1).
 * @example
 *    =NOW()
 */
tr.fn.DateTime["NOW"] = function() {
	// Init now service if not exist
	var funcName = "NOW";
	var nowService = this.getIntervalService(funcName);
	if (!nowService) {
		nowService = tr.fn.DateTimeService.create(funcName, tr.fn._now, 15000); // 15 seconds
		this.setIntervalService(funcName, nowService); // Set the service into formula object
	}

	return /**@type {number}*/(nowService &amp;&amp; nowService["getValue"]()); // Get the cache data from service.
};
/**
 * @function TODAY
 * @this {tr.fn.Formula} // TODAY method is an extension to tr.fn.Formula object. this.getIntervalService and this.setIntervalService are all methods from tr.fn.Formula object and access the same states from the same object (tr.fn.Formula).
 * @memberof DateTime
 * @description
 *    {lang=en} The TODAY function retrieves the current date and time number. Date number since 1 Jan, 1900 and time number in range [0,1). Equivalent to NOW function but it will update every 8 hours.
 *    {lang=ja} TODAY 関数は、現在の日付 &amp; 時刻を返します。範囲 [0,1) の1900年1月1日以降の日付または時刻。NOW 関数と同等ですが、8 時間毎に更新します。
 *    {lang=zh} TODAY 函数获取当前日期与时间数字。起始日期数字是 1900年1月1日，时间数字的范围是 [0,1)。等同于 NOW 函数，但每 8 小时更新一次。
 *    {lang=hant} TODAY 函數獲取當前日期與時間數字。起始日期數字是 1900年1月1日，時間數字的範圍是 [0,1)。等同於 NOW 函數，但每 8 小時更新一次。
 *    {lang=ko} TODAY 함수는 현재 날짜 및 시간 숫자를 검색합니다. 1900년 1월 1일 이후의 날짜 숫자와 범위 [0,1)의 시간 숫자. NOW 함수와 같지만 8시간마다 업데이트합니다.
 *    {lang=ru} The TODAY function retrieves the current date and time number. Date number since 1 Jan, 1900 and time number in range [0,1). Equivalent to NOW function but it will update every 8 hours.
 *    {lang=de} Die Funktion TODAY (HEUTE) ruft das aktuelle Datum und die aktuelle Uhrzeit ab. Das Datum seit 1. Jan. 1900 und die Uhrzeit im Bereich [0,1). Entspricht der Funktion NOW (JETZT), wird aber alle 8 Stunden aktualisiert.
 * @return {?number}
 *    {lang=en} Date number since 1 Jan, 1900 and time number in range [0,1).
 *    {lang=ja} 範囲 [0,1) の1900年1月1日以降の日付または時刻。
 *    {lang=zh} 起始日期数字是 1900年1月1日，时间数字的范围是 [0,1)。
 *    {lang=hant} 起始日期數字是 1900年1月1日，時間數字的範圍是 [0,1)。
 *    {lang=ko} 1900년 1월 1일 이후의 날짜 숫자와 범위 [0,1)의 시간 숫자.
 *    {lang=ru} Date number since 1 Jan, 1900 and time number in range [0,1).
 *    {lang=de} Das Datum seit 1. Jan. 1900 und die Uhrzeit im Bereich [0,1).
 * @example
 *    =TODAY()
 */
tr.fn.DateTime["TODAY"] = function() {
	// Init today service if not exist
	var funcName = "TODAY";
	var todayService = this.getIntervalService(funcName);
	if (!todayService) {
		todayService = tr.fn.DateTimeService.create(funcName, tr.fn._now, 28800000); // 8 hours
		this.setIntervalService(funcName, todayService); // Set the service into formula object
	}

	return /**@type {number}*/(todayService &amp;&amp; todayService["getValue"]()); // Get the cache data from service.
};

//#region DateTimeService
/**
* @ignore
*/
tr.fn.DateTimeService = {};

/**
* @ignore
* @private
* @type {Object}
*/
tr.fn.DateTimeService._dateTimeSubscription = {};

/**
* @ignore
* @public
* @param {string} funcName
* @param {Function} func
* @param {number=} time
* @return {Object}
*/
tr.fn.DateTimeService.create = function(funcName, func, time) {
	var sub = tr.fn.DateTimeService._dateTimeSubscription[funcName];
	if (!sub) {
		sub = new IntervalSubscription(funcName, func, time);
		if(!sub.isValid) {
			return null;
		}
		tr.fn.DateTimeService._dateTimeSubscription[funcName] = sub;
	}
	return sub;
};
//#endregion DateTimeService

/**
 * @ignore
 * @type {string}
 */
tr.fn._localeSetting = "en";
/**
 * @ignore
 * @type {string}
 */
tr.fn._dateTimePattern = "M/D/YY h:mm A";
/**
 * @ignore
 * @description Array of map keys for localization
 * @constant {Array.&lt;string&gt;}
 */
tr.fn._sDay = ["sun", "mon", "tue", "wed", "thu", "fri", "sat"];
/**
 * @ignore
 * @description Array of map keys for localization
 * @constant {Array.&lt;string&gt;}
 */
tr.fn._fDay = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
/**
 * @ignore
 * @description Array of map keys for localization
 * @constant {Array.&lt;string&gt;}
 */
tr.fn._sMonth = ["jan", "feb", "mar", "apr", "may", "jun", "jul", "aug", "sep", "oct", "nov", "dec"];
/**
 * @ignore
 * @description Array of map keys for localization
 * @constant {Array.&lt;string&gt;}
 */
tr.fn._fMonth = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
/**
 * @ignore
 * @description Map of date formatter convertion
 * @constant {Object.&lt;string, Function&gt;}
 */
tr.fn._dateFormat = {
	// Interday time
	"D": function(date, locale) {return "" + date.getDate(); },
	"DD": function(date, locale) { return tr.fn._prefixZero(date.getDate()); },
	"DDD": function(date, locale) { return locale[ tr.fn._sDay[date.getDay()] ]; },
	"D_": function(date, locale) { return locale[ tr.fn._fDay[date.getDay()] ]; },
	"M": function(date, locale) { return "" + (date.getMonth() + 1); },
	"MM": function(date, locale) { return tr.fn._prefixZero(date.getMonth() + 1); },
	"MMM": function(date, locale) { return locale[ tr.fn._sMonth[date.getMonth()] ]; },
	"M_": function(date, locale) { return locale[ tr.fn._fMonth[date.getMonth()] ]; },
	"YY": function(date, locale) { return ("" + date.getFullYear()).substr(-2); },
	"Y_": function(date, locale) { return "" + date.getFullYear(); },
	// Intraday time
	"H": function(date, locale) { return "" + date.getHours(); },
	"H_": function(date, locale) { return tr.fn._prefixZero(date.getHours()); },
	"h": function(date, locale) {
		var temp = date.getHours() % 12;
		return (temp === 0) ? "12" : "" + temp;
	},
	"h_": function(date, locale) {
		var temp = date.getHours() % 12;
		temp = (temp === 0) ? 12 : temp;
		return tr.fn._prefixZero(temp);
	},
	"m": function(date, locale) { return "" + date.getMinutes(); },
	"m_": function(date, locale) { return tr.fn._prefixZero(date.getMinutes()); },
	"S": function(date, locale) { return "" + date.getSeconds(); },
	"S_": function(date, locale) { return tr.fn._prefixZero(date.getSeconds()); },
	// AM/PM suffix
	"A": function(date, locale) { return (date.getHours() &lt; 12) ? locale["AM"] : locale["PM"]; },
	"a": function(date, locale) { return (date.getHours() &lt; 12) ? locale["am"] : locale["pm"]; }
};
/**
 * @ignore
 * @description Map of keys which the lower case character will do the date format as same as upper case character
 * @constant {Object.&lt;string, boolean&gt;}
 */
tr.fn._lowerCaseDateFormat = {
	"d": true,
	"y": true,
	"s": true
};
/**
 * @ignore
 * @constant {number}
 */
tr.fn._MILLISECONDS_OF_DAY = 24 * 60 * 60 * 1000; // 86400000
/**
 * @ignore
 * @constant {number}
 */
tr.fn._DIFF_DAYS = 25567 + 2; // Start 1 on 1 Jan 1900 + 1 for error on 29 Feb 1900 (Not existing date but existing in window)
/**
 * @ignore
 * @constant {number}
 */
tr.fn._START_DATE = Date.UTC(1900, 0, 1); // 1 Jan 1900
/**
 * @ignore
 * @constant {number}
 */
tr.fn._NEW_PERIOD_DATE = Date.UTC(1900, 2, 1); // 1 Mar 1900

// Second
/**
 * @ignore
 * @constant {number}
 */
tr.fn._A_DAY = 24 * 60 * 60;
/**
 * @ignore
 * @constant {number}
 */
tr.fn._AN_HOUR = 60 * 60;
/**
 * @ignore
 * @constant {number}
 */
tr.fn._A_MINUTE = 60;

goog.exportSymbol("tr.fn.DateTime", tr.fn.DateTime);

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="AdFin.html">AdFin</a></li><li><a href="DateTime.html">DateTime</a></li><li><a href="Info.html">Info</a></li><li><a href="Logic.html">Logic</a></li><li><a href="Math.html">Math</a></li><li><a href="Realtime.html">Realtime</a></li><li><a href="Statistic.html">Statistic</a></li><li><a href="Text.html">Text</a></li><li><a href="tr.ElementFrameWork.html">ElementFrameWork</a></li><li><a href="tr.PipDefinition.html">PipDefinition</a></li></ul><h3>Classes</h3><ul><li><a href="tr.ADCSubscription.html">ADCSubscription</a></li><li><a href="tr.AdFinSubscription.html">AdFinSubscription</a></li><li><a href="tr.cgrid.editor.TextBox.html">TextBox</a></li><li><a href="tr.cgrid.filter.TextBox.html">TextBox</a></li><li><a href="tr.cgrid.formatter.AsyncFormatter.html">AsyncFormatter</a></li><li><a href="tr.cgrid.formatter.CheckBox.html">CheckBox</a></li><li><a href="tr.cgrid.formatter.UpDownColor.html">UpDownColor</a></li><li><a href="tr.ColumnStats.html">ColumnStats</a></li><li><a href="tr.CompositeGrid.html">CompositeGrid</a></li><li><a href="tr.DataCache.html">DataCache</a></li><li><a href="tr.DataTable.html">DataTable</a></li><li><a href="tr.DataView.html">DataView</a></li><li><a href="tr.DropDown.html">DropDown</a></li><li><a href="tr.ElementControl.html">ElementControl</a></li><li><a href="tr.ElementWrapper.html">ElementWrapper</a></li><li><a href="tr.Event.html">Event</a></li><li><a href="tr.EventDispatcher.html">EventDispatcher</a></li><li><a href="tr.EventDispatcher.extendClass-tempCtor.html">tempCtor</a></li><li><a href="tr.EventManager.html">EventManager</a></li><li><a href="tr.FieldFormatter.html">FieldFormatter</a></li><li><a href="tr.fn.Engine.html">Engine</a></li><li><a href="tr.fn.Formula.html">Formula</a></li><li><a href="tr.fn.VariableToken.html">VariableToken</a></li><li><a href="tr.Grid.html">Grid</a></li><li><a href="tr.grid.BidOfferSpan.html">BidOfferSpan</a></li><li><a href="tr.grid.Blinker.html">Blinker</a></li><li><a href="tr.grid.Cell.html">Cell</a></li><li><a href="tr.grid.CellBlinkingPlugin.html">CellBlinkingPlugin</a></li><li><a href="tr.grid.CellEditingPlugin.html">CellEditingPlugin</a></li><li><a href="tr.grid.CellFloatingPanel.html">CellFloatingPanel</a></li><li><a href="tr.grid.CellPainter.html">CellPainter</a></li><li><a href="tr.grid.CellSpan.html">CellSpan</a></li><li><a href="tr.grid.CellSpans.html">CellSpans</a></li><li><a href="tr.grid.CellWriter.html">CellWriter</a></li><li><a href="tr.grid.CheckboxColumnPlugin.html">CheckboxColumnPlugin</a></li><li><a href="tr.grid.CollapsibleHeaderPlugin.html">CollapsibleHeaderPlugin</a></li><li><a href="tr.grid.ColumnFilterPlugin.html">ColumnFilterPlugin</a></li><li><a href="tr.grid.ColumnGroupingPlugin.html">ColumnGroupingPlugin</a></li><li><a href="tr.grid.ColumnSelectionPlugin.html">ColumnSelectionPlugin</a></li><li><a href="tr.grid.ColumnStackingPlugin.html">ColumnStackingPlugin</a></li><li><a href="tr.grid.ColumnWidthAdjustingPlugin.html">ColumnWidthAdjustingPlugin</a></li><li><a href="tr.grid.Conflator.html">Conflator</a></li><li><a href="tr.grid.DataSourceTreePlugin.html">DataSourceTreePlugin</a></li><li><a href="tr.grid.DirectContentBindingPlugin.html">DirectContentBindingPlugin</a></li><li><a href="tr.grid.DragAndDropTitlePlugin.html">DragAndDropTitlePlugin</a></li><li><a href="tr.grid.DraggableContentPlugin.html">DraggableContentPlugin</a></li><li><a href="tr.grid.FindBar.html">FindBar</a></li><li><a href="tr.grid.FindBarPlugin.html">FindBarPlugin</a></li><li><a href="tr.grid.GroupStatisticsPlugin.html">GroupStatisticsPlugin</a></li><li><a href="tr.grid.HeatMapRenderer.html">HeatMapRenderer</a></li><li><a href="tr.grid.HScrollbar.html">HScrollbar</a></li><li><a href="tr.grid.IndexMarker.html">IndexMarker</a></li><li><a href="tr.grid.MovableHeaderPlugin.html">MovableHeaderPlugin</a></li><li><a href="tr.grid.NumberFormatter.html">NumberFormatter</a></li><li><a href="tr.grid.PercentBar.html">PercentBar</a></li><li><a href="tr.grid.PercentBarRenderer.html">PercentBarRenderer</a></li><li><a href="tr.grid.Plugin.html">Plugin</a></li><li><a href="tr.grid.RangeBar.html">RangeBar</a></li><li><a href="tr.grid.ResizableTitlePlugin.html">ResizableTitlePlugin</a></li><li><a href="tr.grid.Reverter.html">Reverter</a></li><li><a href="tr.grid.RowHeightAdjustingPlugin.html">RowHeightAdjustingPlugin</a></li><li><a href="tr.grid.RowSelectionPlugin.html">RowSelectionPlugin</a></li><li><a href="tr.grid.Scrollbar.html">Scrollbar</a></li><li><a href="tr.grid.SectionSettings.html">SectionSettings</a></li><li><a href="tr.grid.SmartTooltipsPlugin.html">SmartTooltipsPlugin</a></li><li><a href="tr.grid.SortableTitlePlugin.html">SortableTitlePlugin</a></li><li><a href="tr.grid.TreeIndentingPlugin.html">TreeIndentingPlugin</a></li><li><a href="tr.grid.Virtualizer.html">Virtualizer</a></li><li><a href="tr.grid.VScrollbar.html">VScrollbar</a></li><li><a href="tr.grid.ZoomPlugin.html">ZoomPlugin</a></li><li><a href="tr.HttpRequest.html">HttpRequest</a></li><li><a href="tr.IntervalSubscription.html">IntervalSubscription</a></li><li><a href="tr.LayoutGrid.html">LayoutGrid</a></li><li><a href="tr.ListMenu.html">ListMenu</a></li><li><a href="tr.MenuItem.html">MenuItem</a></li><li><a href="tr.MockArchive.html">MockArchive</a></li><li><a href="tr.MockJET.html">MockJET</a></li><li><a href="tr.MockQuotes.html">MockQuotes</a></li><li><a href="tr.MockQuotes2.html">MockQuotes2</a></li><li><a href="tr.MockSubscription.html">MockSubscription</a></li><li><a href="tr.MockSubscriptions.html">MockSubscriptions</a></li><li><a href="tr.Popup.html">Popup</a></li><li><a href="tr.PopupMenu.html">PopupMenu</a></li><li><a href="tr.PrintTrait.html">PrintTrait</a></li><li><a href="tr.RequestQueue.html">RequestQueue</a></li><li><a href="tr.Segment.html">Segment</a></li><li><a href="tr.SegmentCollection.html">SegmentCollection</a></li><li><a href="tr.TSISubscription.html">TSISubscription</a></li></ul><h3>Interfaces</h3><ul><li><a href="tr.cgrid.ICompositeExtension.html">ICompositeExtension</a></li><li><a href="tr.grid.IPlugin.html">IPlugin</a></li><li><a href="tr.IElementControl.html">IElementControl</a></li><li><a href="tr.ILayoutGrid.html">ILayoutGrid</a></li></ul><h3>Events</h3><ul><li><a href="tr.CompositeGrid.html#event:cellClicked">cellClicked</a></li><li><a href="tr.CompositeGrid.html#event:cellDblClicked">cellDblClicked</a></li><li><a href="tr.CompositeGrid.html#event:cellMouseDown">cellMouseDown</a></li><li><a href="tr.CompositeGrid.html#event:cellRightClicked">cellRightClicked</a></li><li><a href="tr.CompositeGrid.html#event:columnSorted">columnSorted</a></li><li><a href="tr.CompositeGrid.html#event:editorAttached">editorAttached</a></li><li><a href="tr.CompositeGrid.html#event:editorDetached">editorDetached</a></li><li><a href="tr.CompositeGrid.html#event:filterAdded">filterAdded</a></li><li><a href="tr.CompositeGrid.html#event:filterCleared">filterCleared</a></li><li><a href="tr.CompositeGrid.html#event:filterModified">filterModified</a></li><li><a href="tr.CompositeGrid.html#event:filterRemoved">filterRemoved</a></li><li><a href="tr.CompositeGrid.html#event:mouseLeaveCell">mouseLeaveCell</a></li><li><a href="tr.CompositeGrid.html#event:mouseOverCell">mouseOverCell</a></li><li><a href="tr.CompositeGrid.html#event:pageChanged">pageChanged</a></li><li><a href="tr.CompositeGrid.html#event:selectionChanged">selectionChanged</a></li><li><a href="tr.DataCache.html#event:dataChanged">dataChanged</a></li><li><a href="tr.DataCache.html#event:dataComposed">dataComposed</a></li><li><a href="tr.DataTable.html#event:dataChanged">dataChanged</a></li><li><a href="tr.DataTable.html#event:dataComposed">dataComposed</a></li><li><a href="tr.DataView.html#event:beforeFiltering">beforeFiltering</a></li><li><a href="tr.DataView.html#event:beforeGroupAdded">beforeGroupAdded</a></li><li><a href="tr.DataView.html#event:dataChanged">dataChanged</a></li><li><a href="tr.DataView.html#event:groupAdded">groupAdded</a></li><li><a href="tr.DataView.html#event:groupCriteriaChanged">groupCriteriaChanged</a></li><li><a href="tr.DataView.html#event:pageCountChanged">pageCountChanged</a></li><li><a href="tr.DataView.html#event:pageIndexChanged">pageIndexChanged</a></li><li><a href="tr.DataView.html#event:preDisposed">preDisposed</a></li><li><a href="tr.Formula.html#event:dataCacheChanged">dataCacheChanged</a></li><li><a href="tr.grid.CellEditingPlugin.html#event:cancelled">cancelled</a></li><li><a href="tr.grid.CellEditingPlugin.html#event:change">change</a></li><li><a href="tr.grid.CellEditingPlugin.html#event:closed">closed</a></li><li><a href="tr.grid.CellEditingPlugin.html#event:editorOpened">editorOpened</a></li><li><a href="tr.grid.CellEditingPlugin.html#event:preEditorOpening">preEditorOpening</a></li><li><a href="tr.grid.CheckboxColumnPlugin.html#event:clicked">clicked</a></li><li><a href="tr.grid.CollapsibleHeaderPlugin.html#event:clicked">clicked</a></li><li><a href="tr.grid.CollapsibleHeaderPlugin.html#event:contentBindinig">contentBindinig</a></li><li><a href="tr.grid.CollapsibleHeaderPlugin.html#event:footerBinding">footerBinding</a></li><li><a href="tr.grid.CollapsibleHeaderPlugin.html#event:headerBinding">headerBinding</a></li><li><a href="tr.grid.ColumnFilterPlugin.html#event:click">click</a></li><li><a href="tr.grid.ColumnFilterPlugin.html#event:iconCreated">iconCreated</a></li><li><a href="tr.grid.ColumnGroupingPlugin.html#event:columnCollapsed">columnCollapsed</a></li><li><a href="tr.grid.ColumnGroupingPlugin.html#event:groupChanged">groupChanged</a></li><li><a href="tr.grid.ColumnGroupingPlugin.html#event:render">render</a></li><li><a href="tr.grid.ColumnStackingPlugin.html#event:clicked">clicked</a></li><li><a href="tr.grid.ColumnStackingPlugin.html#event:iconCreated">iconCreated</a></li><li><a href="tr.grid.DragAndDropTitlePlugin.html#event:columnMoved">columnMoved</a></li><li><a href="tr.grid.DragAndDropTitlePlugin.html#event:dragged">dragged</a></li><li><a href="tr.grid.DraggableContentPlugin.html#event:drag">drag</a></li><li><a href="tr.grid.DraggableContentPlugin.html#event:dragEnd">dragEnd</a></li><li><a href="tr.grid.DraggableContentPlugin.html#event:dragStart">dragStart</a></li><li><a href="tr.grid.FindBarPlugin.html#event:clicked">clicked</a></li><li><a href="tr.grid.MovableHeaderPlugin.html#event:dragged">dragged</a></li><li><a href="tr.grid.MovableHeaderPlugin.html#event:groupMoved">groupMoved</a></li><li><a href="tr.grid.MovableHeaderPlugin.html#event:sectionMoved">sectionMoved</a></li><li><a href="tr.grid.RowSelectionPlugin.html#event:selectionChanged">selectionChanged</a></li><li><a href="tr.grid.SortableTitlePlugin.html#event:clicked">clicked</a></li><li><a href="tr.grid.SortableTitlePlugin.html#event:columnSorted">columnSorted</a></li><li><a href="tr.grid.SortableTitlePlugin.html#event:preClicked">preClicked</a></li><li><a href="tr.grid.SortableTitlePlugin.html#event:preDataSorting">preDataSorting</a></li><li><a href="tr.grid.TreeIndentingPlugin.html#event:clicked">clicked</a></li><li><a href="tr.grid.TreeIndentingPlugin.html#event:contentBindinig">contentBindinig</a></li><li><a href="tr.grid.TreeIndentingPlugin.html#event:footerBinding">footerBinding</a></li><li><a href="tr.grid.TreeIndentingPlugin.html#event:headerBinding">headerBinding</a></li><li><a href="tr.Grid.html#event:columnAdded">columnAdded</a></li><li><a href="tr.Grid.html#event:columnAlignmentChanged">columnAlignmentChanged</a></li><li><a href="tr.Grid.html#event:columnRemoved">columnRemoved</a></li><li><a href="tr.Grid.html#event:columnVisibilityChanged">columnVisibilityChanged</a></li><li><a href="tr.Grid.html#event:dataSourceChanged">dataSourceChanged</a></li><li><a href="tr.Grid.html#event:postSectionDataBinding">postSectionDataBinding</a></li><li><a href="tr.Grid.html#event:rowExpansionBinding">rowExpansionBinding</a></li><li><a href="tr.Grid.html#event:rowHighlighted">rowHighlighted</a></li><li><a href="tr.Grid.html#event:sectionAdded">sectionAdded</a></li><li><a href="tr.Grid.html#event:widthChanged">widthChanged</a></li><li><a href="tr.HttpRequest.html#event:abort">abort</a></li><li><a href="tr.HttpRequest.html#event:error">error</a></li><li><a href="tr.HttpRequest.html#event:load">load</a></li><li><a href="tr.HttpRequest.html#event:loadend">loadend</a></li><li><a href="tr.HttpRequest.html#event:loadstart">loadstart</a></li><li><a href="tr.HttpRequest.html#event:timeout">timeout</a></li><li><a href="tr.IElementControl.html#event:blur">blur</a></li><li><a href="tr.IElementControl.html#event:change">change</a></li><li><a href="tr.IElementControl.html#event:click">click</a></li><li><a href="tr.IElementControl.html#event:contextmenu">contextmenu</a></li><li><a href="tr.IElementControl.html#event:dblclick">dblclick</a></li><li><a href="tr.IElementControl.html#event:drag">drag</a></li><li><a href="tr.IElementControl.html#event:dragend">dragend</a></li><li><a href="tr.IElementControl.html#event:dragenter">dragenter</a></li><li><a href="tr.IElementControl.html#event:dragleave">dragleave</a></li><li><a href="tr.IElementControl.html#event:dragover">dragover</a></li><li><a href="tr.IElementControl.html#event:dragstart">dragstart</a></li><li><a href="tr.IElementControl.html#event:drop">drop</a></li><li><a href="tr.IElementControl.html#event:focus">focus</a></li><li><a href="tr.IElementControl.html#event:formchange">formchange</a></li><li><a href="tr.IElementControl.html#event:forminput">forminput</a></li><li><a href="tr.IElementControl.html#event:input">input</a></li><li><a href="tr.IElementControl.html#event:invalid">invalid</a></li><li><a href="tr.IElementControl.html#event:keydown">keydown</a></li><li><a href="tr.IElementControl.html#event:keypress">keypress</a></li><li><a href="tr.IElementControl.html#event:keyup">keyup</a></li><li><a href="tr.IElementControl.html#event:mousedown">mousedown</a></li><li><a href="tr.IElementControl.html#event:mousemove">mousemove</a></li><li><a href="tr.IElementControl.html#event:mouseout">mouseout</a></li><li><a href="tr.IElementControl.html#event:mouseover">mouseover</a></li><li><a href="tr.IElementControl.html#event:mouseup">mouseup</a></li><li><a href="tr.IElementControl.html#event:mousewheel">mousewheel</a></li><li><a href="tr.IElementControl.html#event:reset">reset</a></li><li><a href="tr.IElementControl.html#event:scroll">scroll</a></li><li><a href="tr.IElementControl.html#event:select">select</a></li><li><a href="tr.IElementControl.html#event:submit">submit</a></li><li><a href="tr.ILayoutGrid.html#event:blur">blur</a></li><li><a href="tr.ILayoutGrid.html#event:change">change</a></li><li><a href="tr.ILayoutGrid.html#event:click">click</a></li><li><a href="tr.ILayoutGrid.html#event:contextmenu">contextmenu</a></li><li><a href="tr.ILayoutGrid.html#event:dblclick">dblclick</a></li><li><a href="tr.ILayoutGrid.html#event:drag">drag</a></li><li><a href="tr.ILayoutGrid.html#event:dragend">dragend</a></li><li><a href="tr.ILayoutGrid.html#event:dragenter">dragenter</a></li><li><a href="tr.ILayoutGrid.html#event:dragleave">dragleave</a></li><li><a href="tr.ILayoutGrid.html#event:dragover">dragover</a></li><li><a href="tr.ILayoutGrid.html#event:dragstart">dragstart</a></li><li><a href="tr.ILayoutGrid.html#event:drop">drop</a></li><li><a href="tr.ILayoutGrid.html#event:focus">focus</a></li><li><a href="tr.ILayoutGrid.html#event:formchange">formchange</a></li><li><a href="tr.ILayoutGrid.html#event:forminput">forminput</a></li><li><a href="tr.ILayoutGrid.html#event:input">input</a></li><li><a href="tr.ILayoutGrid.html#event:invalid">invalid</a></li><li><a href="tr.ILayoutGrid.html#event:keydown">keydown</a></li><li><a href="tr.ILayoutGrid.html#event:keypress">keypress</a></li><li><a href="tr.ILayoutGrid.html#event:keyup">keyup</a></li><li><a href="tr.ILayoutGrid.html#event:mousedown">mousedown</a></li><li><a href="tr.ILayoutGrid.html#event:mousemove">mousemove</a></li><li><a href="tr.ILayoutGrid.html#event:mouseout">mouseout</a></li><li><a href="tr.ILayoutGrid.html#event:mouseover">mouseover</a></li><li><a href="tr.ILayoutGrid.html#event:mouseup">mouseup</a></li><li><a href="tr.ILayoutGrid.html#event:mousewheel">mousewheel</a></li><li><a href="tr.ILayoutGrid.html#event:reset">reset</a></li><li><a href="tr.ILayoutGrid.html#event:scroll">scroll</a></li><li><a href="tr.ILayoutGrid.html#event:select">select</a></li><li><a href="tr.ILayoutGrid.html#event:submit">submit</a></li><li><a href="tr.LayoutGrid.html#event:rowCountChanged">rowCountChanged</a></li><li><a href="tr.LayoutGrid.html#event:rowHeightChanged">rowHeightChanged</a></li><li><a href="tr.LayoutGrid.html#event:rowHighlighted">rowHighlighted</a></li><li><a href="tr.Popup.html#event:hidden">hidden</a></li><li><a href="tr.Popup.html#event:shown">shown</a></li><li><a href="tr.PopupMenu.html#event:hidden">hidden</a></li><li><a href="tr.PopupMenu.html#event:shown">shown</a></li><li><a href="tr.PrintTrait.html#event:afterprint">afterprint</a></li><li><a href="tr.PrintTrait.html#event:beforeprint">beforeprint</a></li><li><a href="tr.PrintTrait.html#event:pageCounting">pageCounting</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cellRef%255Bundefined%255D">cellRef[undefined]</a></li><li><a href="global.html#e%255Bundefined%255D">e[undefined]</a></li><li><a href="global.html#.textContent">.textContent</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#input%255Bundefined%255D">input[undefined]</a></li><li><a href="global.html#q%255Bundefined%255D">q[undefined]</a></li><li><a href="global.html#sortingDef%255B1%255D">sortingDef[1]</a></li></ul>
</nav>


<script src="scripts/linenumber.js"> </script>
<script src="scripts/prettify.js"> </script>
<script> prettyPrint(); </script>
</body>
</html>
