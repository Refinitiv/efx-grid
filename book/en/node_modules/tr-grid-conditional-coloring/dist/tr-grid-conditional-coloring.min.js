!function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var n={inherits:function(e,t){function o(){}o.prototype=t.prototype,e.prototype=new o,e.prototype.constructor=e,e.base=function(e,o,n){o||(o="constructor");for(var i=arguments.length,r=new Array(i),l=2;l<i;l++)r[l-2]=arguments[l];return t.prototype[o].apply(e,r)}}},i=function(){};i.prototype._events=null,i.prototype._listenerCount=0,i.prototype.addEventListener=function(e,t){if(e&&t){this._events||(this._events={});var o=this._events[e];o?o.indexOf(t)<0&&(o.push(t),++this._listenerCount):(this._events[e]=[t],++this._listenerCount)}},i.prototype.removeEventListener=function(e,t){var o=this._events?this._events[e]:null;if(o){var n=o.indexOf(t);n>=0&&(o.splice(n,1),--this._listenerCount)}},i.prototype.removeAllEventListeners=function(){this._events=null,this._listenerCount=0},i.prototype.hasListener=function(e){if(this._listenerCount){if(e){var t=this._events?this._events[e]:null;return!!t&&t.length>0}return!0}return!1},i.prototype.getListener=function(e,t){if(e){var o=this._events?this._events[e]:null;if(o)return t||(t=0),o[t]||null}return null},i.prototype.addListener=function(e,t){var o=e?e[t]:null;"function"==typeof o&&this.addEventListener(t,o)},i.prototype._prepareEventArguments=function(e,t){return t},i.prototype._dispatch=function(e,t){var o=this._events?this._events[e]:null;if(o){t=this._prepareEventArguments(e,t);for(var n=o.length,i=0;i<n;++i)o[i](t)}};i.preventDefault=function(e){e&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())};var r=function(e,t,o){this.resolve=this.resolve.bind(this),this.reject=this.reject.bind(this),"function"==typeof e&&(this._resolveHandler=e),"function"==typeof t&&(this._rejectHandler=t),null!=o&&(this._ctx=o),this.promise=new Promise(function(e,t){this._resolve=e,this._reject=t}.bind(this))};r.prototype.promise=null,r.prototype._resolve=null,r.prototype._reject=null,r.prototype._resolveHandler=null,r.prototype._rejectHandler=null,r.prototype._ctx=null,r.prototype._fulfilled=!1,r.prototype.resolve=function(e){if(this._resolve){if(this._resolveHandler){var t=this._resolveHandler(e,this._ctx||this);null!=t&&(e=t)}this._resolve(e),this._finally()}},r.prototype.reject=function(e){if(this._reject){if(this._rejectHandler){var t=this._rejectHandler(e,this._ctx||this);null!=t&&(e=t)}this._reject(e),this._finally()}},r.prototype.isFulfilled=function(){return this._fulfilled},r.prototype._finally=function(){this._fulfilled=!0,this._ctx=this._resolveHandler=this._rejectHandler=null,this._resolve=this._reject=null};var l=function(){};n.inherits(l,i),l.prototype._hosts=null,l.prototype._compositeGrid=null,l.prototype._realTimeGrid=null,l.prototype._rowGetter=null,l.prototype._initializedGrid=!1,l.prototype.listen=l.prototype.addEventListener,l.prototype.unlisten=l.prototype.removeEventListener,l.prototype.afterInit=function(e,t,o){var n=null;o&&o.getCoreGrid&&(n=o.getCoreGrid()),n&&(this.getGridApi()||this.setGridWrapper("compositegrid",o),this._compositeGrid&&n.loadPlugin(this,t)),this._initializedGrid||(this._initializedGrid=!0,this._rowGetter=this._realTimeGrid?u:a,this._afterInit())},l.prototype._afterInit=function(){},l.prototype._dispose=function(){this._hosts&&(this._hosts.length||(this._compositeGrid=this._realTimeGrid=null,this._initializedGrid=!1))},l.prototype.hasMultiTableSupport=function(){return!1},l.prototype._prepareEventArguments=function(e,t){return t||(t={}),t.api=this.getGridApi(),t},l.prototype.getName=function(){return"GridPlugin"},l.prototype.initialize=function(e,t){},l.prototype.unload=function(e){this._dispose()},l.prototype.getRelativeGrid=function(e){var t=null;if(e.target){var o=(t=e.target).api;if(o&&o.getCoreGrid)return o.getCoreGrid()}else e.getElement?t=e.getElement():1===e.nodeType&&(t=e);if(t)for(var n=this._hosts.length;--n>=0;){var i=this._hosts[n];if(i.getElement().contains(t))return i}return null},l.prototype.setGridWrapper=function(e,t){e&&("compositegrid"===(e=e.toLowerCase())?this._compositeGrid=t:"realtimegrid"===e&&(this._realTimeGrid=t))},l.prototype.getGridApi=function(e){if(null==e)return this._compositeGrid||this._realTimeGrid;var t="number"==typeof e?this._hosts[e]:e;return t&&t._wrapper||null},l.prototype.getColumnName=function(e){if(this._compositeGrid){var t=this._compositeGrid.getColumnModel(e);if(t)return t.title?t.title:t.field}else{var o=this.getColumnIndex(e),n=this._realTimeGrid.getColumnDefinition(o);if(n)return n.getName()}return""},l.prototype.getColumnIndex=function(e){if("number"==typeof e)return e;if(this._compositeGrid){var t=this._compositeGrid.getColumnFields().indexOf(e);return t>-1?t:this._compositeGrid.getColumnIndex(e)}return this._realTimeGrid.getColumnIndex(e)},l.prototype.getColumnIndices=function(e){var t=this.getGridApi();if(t.getColumnIndices)return t.getColumnIndices(e);if(this._compositeGrid){for(var o,n=this._compositeGrid.getColumnFields(),i=this._compositeGrid.getColumnCount(),r=[],l=0;l<e.length;l++)if("number"==typeof(o=e[l]))o>=0&&o<i&&r.push(o);else{var s=n.indexOf(o);-1!==s&&r.push(s)}return r}return this._realTimeGrid.getColumnIndices(e)},l.prototype.getColumnId=function(e){if("string"==typeof e)return e;var t=this.getColumnCount();if(e<0||e>=t)return"";if(this._compositeGrid)return this._compositeGrid.getColumnId(e);var o=this._realTimeGrid.getColumnDefinition(e);return o?o.getId():""},l.prototype.getColumnIds=function(){return this._hosts&&this._hosts.length?this._hosts[0].getColumnIds():[]},l.prototype.getColumnField=function(e){return this._hosts&&this._hosts.length?this._hosts[0].getColumnField(e):""},l.prototype.getColumnFields=function(){return this._hosts&&this._hosts.length?this._hosts[0].getColumnFields():[]},l.prototype.getColumnCount=function(){if(this._hosts){var e=this._hosts[0];return e?e.getColumnCount():0}return 0},l.prototype._moveColumnById=function(e,t){var o=this._hosts,n=o?o.length:0;if(n){for(var i=0,r=0;r<n;++r)i|=o[r].moveColumnById(e,t);return!!i}return!1},l.prototype._reorderColumns=function(e,t){var o=this._hosts,n=o?o.length:0;if(n){for(var i=0,r=0;r<n;++r)i|=o[r].reorderColumns(e,t);return!!i}return!1},l.prototype._loadPlugin=function(e,t,o){return e||(e=t.getPlugin(o))||(e=t.loadPlugin(o))&&this._initializedGrid&&(e._initializedGrid=!0),e},l.prototype._requestPlugin=function(e,t,o){return this._initializedGrid?l.requestPlugin(e,t,o,this._compositeGrid,this._realTimeGrid):Promise.reject("Plugin should be requested after the initialization")},l.requestPlugin=function(e,t,o,n,i){var s=null;if(e){var a=null;1===e.nodeType?a=e.api:e.getCoreGrid?a=e:e.getPlugin&&(s=e),a&&(s=a.getCoreGrid(),n||i||(a.getModel?n=a:i=a))}if(!s)return Promise.reject("Cannot find grid element");var u=s.getPlugin(t);if(u)return Promise.resolve(u);var d=new r;return setTimeout(l._onPluginRequested.bind(null,{grid:s,pluginRef:t,compositeGrid:n,realTimeGrid:i,config:o,deferred:d}),10),d.promise},l._onPluginRequested=function(e){var t=e.grid;if(!t.getElement())return e.deferred.reject("Grid has been disposed before the plugin is fully loaded: "+e.pluginRef);var o=t.getPlugin(e.pluginRef);if(o)return e.deferred.resolve(o);var n=!1;return e.pluginRef.beforeInit&&(n=!0,e.pluginRef.beforeInit(t.getElement(),e.config,!0)),(o=t.loadPlugin(e.pluginRef,e.config))?(!n&&o.beforeInit&&(n=!0,o.beforeInit(t.getElement(),e.config)),o.setGridWrapper&&(e.compositeGrid?o.setGridWrapper("compositegrid",e.compositeGrid):e.realTimeGrid&&o.setGridWrapper("realtimegrid",e.realTimeGrid)),o.afterInit&&o.afterInit(),e.deferred.resolve(o)):e.deferred.reject("Unable to load required dependency: "+e.pluginRef)},l.prototype._getPlugin=function(e,t){return null==t&&(t=this._hosts[0]),t?t.getPlugin(e):null},l.prototype._getColumnData=function(e,t){return null==t&&(t=this._hosts[0]),t?t.getColumnData(e):null},l.prototype._getColumnOption=function(e,t,o){var n=this._getColumnData(e,o);return n?n[t]:null},l.prototype._newColumnData=function(e,t){if(null==t&&(t=this._hosts[0]),!t)return{};var o=t.getColumnData(e);return o||(o=t.setColumnData(e,{})),o},l.prototype._getField=function(e){var t=this._compositeGrid||this._realTimeGrid;return t?t.getColumnField(e):""},l.prototype._getRowData=function(e){return this._realTimeGrid&&e?e.ROW_DEF.getRowData():e},l.prototype._getRow=function(e,t){return d(e.getRowDataAt(t))},l.prototype._getData=function(e,t,o){var n=this._getRow(e,t);return n?n[o]:void 0},l.prototype._setData=function(e,t,o,n){if(this._realTimeGrid){var i=s(e,t);i&&i.setData(o,n)}else"number"==typeof t?e.setDataAt(t,o,n):e.setData(t,o,n)},l.prototype._setRowData=function(e,t,o){if(this._realTimeGrid){var n=s(e,t);n&&n.setRowData(o)}else"number"==typeof t?e.setRowDataAt(t,o):e.setRowData(t,o)},l.prototype._setStaticData=function(e,t,o,n){if(this._realTimeGrid){var i=s(e,t);i&&i.setStaticData(o,n)}else this._setData(e,t,o,n)},l.prototype._setColumnData=function(e,t,o,n){if(t){var i=Array.isArray(n)?n:e.getAllRowIds(!0),r=i?i.length:0;if(r)if(1!==r){var l=Array.isArray(o)?o:i.map((function(){return o}));if(this._realTimeGrid){for(var s=0;s<r;++s){var a=e.getRowData(i[s]);if(a){var u=a.ROW_DEF;u&&(u.getRowData()[t]=l[s])}}e.dispatchGlobalChange||(e=e.getDataSource()),e&&e.dispatchGlobalChange&&e.dispatchGlobalChange()}else e.setColumnData(t,l,i)}else this._setData(e,i[0],t,Array.isArray(o)?o[0]:o)}},l.prototype._activateColumnRenderer=function(e,t,o){if(null!=e){var n=this._realTimeGrid;n?n.activateColumnRenderer(e,t,o):"function"==typeof o?this._hosts[0].setColumnDataBindingHandler(e,o):this._hosts[0].setColumnDataBindingHandler(e,null)}};var s=function(e,t){var o="number"==typeof t?e.getRowDataAt(t):e.getRowData(t);return o&&o.ROW_DEF||null},a=function(e){return e},u=function(e){return e?e.ROW_DEF.getRowData():null},d=function(e){if(e){var t=e.ROW_DEF;return t?t.getRowData():e}return null},c=function(e,t,o){if(!e)return null;if(!t||e===t)return e;var n;if(o)for(var i=o.length,r=0;r<i;++r)(n=o[r])&&p(e,t,n);else for(n in t)p(e,t,n);return e},p=function(e,t,o){var n=t[o];if(null!=n){var i=e[o];Array.isArray(i)?e[o]=i.concat(n):Array.isArray(n)&&i?e[o]=n.concat(i):e[o]=n}},f=function(e){return Array.isArray(e)?"{\n"+e.join("\n")+"\n}":e},h=function(e){return e.replace(/\n+/g,"\n\t").replace(/\n\t}$/,"\n}")},_=function(e,t){if(!e)return null;var o=document.createElement("style");o.textContent="\n"+e+"\n";var n,i=function(e){var t;if(e&&(e.shadowRoot?t=e.shadowRoot:e.getRootNode&&(t=e.getRootNode()),t&&t!==document&&t!==e))return t;return null}(t),r=!0;return i||(r=!1,i=document.head),r&&i.children&&i.children.length&&(n=i.children[0]),n?i.insertBefore(o,n):i.appendChild(o),o},g=function(e,t){for(var o in t||(t=[]),e){var n=e[o];"object"==typeof n?g(n,t):t.push(n)}return t},m=function(e){if(!e||"string"!=typeof e)return"";if("#"===e.charAt(0))return e;var t=e.match(/\d+/g);if(!t||t.length<3)return e;for(var o="#",n=0;n<3;n++){var i=+t[n];i>=16||(o+="0"),o+=i?i.toString(16).toUpperCase():"0"}return o},v={"⇧":1,"B⇧":1,"↑":1,"B↑":1,26:1,1:1,'"1"':1,"-1":-1,"⇩":-1,"B⇩":-1,"↓":-1,"B↓":-1,27:-1,2:-1,'"2"':-1},C={CF_TICK:1,PRCTCK_1:1,BID_TICK:1,ASK_TICK:1},y={},b=function(e,t){"attributes"==t.type&&"lang"==t.attributeName&&(e.lang=t.target.lang||"en")},T=function(e,t,o){"attributes"===o.type&&(null!=t?o.attributeName===t&&e(o.target.getAttribute(t)):e(o.target))};y._getNewId=function(){return"observer_"+ ++y._id},y._addObserver=function(e,t,o){var n=o;n||(n={}),n.attributes=!0,y._observer.observe(e,n),y._addListener(e,t)},y._onMutationCallback=function(e){for(var t=0;t<e.length;t++)for(var o=e[t],n=y._listeners[o.target._observeId],i=0;i<n.length;i++)n[i](o)},y._addListener=function(e,t){var o=y._listeners;if(o||(o=y._listeners={}),!e._observeId){var n=y._getNewId();e._observeId=n}o[e._observeId]||(o[e._observeId]=[]);var i=o[e._observeId];i.indexOf(t)<0&&i.push(t)},y.addLanguageListener=function(e){e&&(e.lang=document.documentElement.lang||"en",y._addObserver(document.documentElement,b.bind(null,e)))},y.addAttributeListener=function(e,t,o){e&&t&&y._addObserver(e,T.bind(null,t,o))},y._observer=new MutationObserver(y._onMutationCallback),y._listeners={},y._id=0;var w={en:!0,de:!0,ja:!0,zh:!0,"zh-Hant":!0},k={_deferred:null,themeReady:null,_defaultColors:{up:"#39C46E",down:"#F5475B",level:"#C2C2C2",tickUp:"#39C46E",tickDown:"#F5475B",baseGrid:"#1A1A1C",baseText:"#C2C2C2",trackColor:"#FF9933"}};k.themeColors=k._defaultColors,k._components={},k._themeName="",k._elfVersion=0,k._dummyIcon=null,k._iconLoaded=!1,k._profileName=null,k._callbacks=[],k._observed=!1,k._pendingResolve=!1,k._themeLoaded=!1,k._icons={"elf-theme-halo":{rowGrouping:{expander:"down"},sorting:{ascending:"hollow-arrow-up",descending:"hollow-arrow-down",sortable:"sort-up-down"},columnStack:{stack:"map-layers",expand:"right",collapse:"left"}},"elf-theme-solar":{columnStack:{stack:"list",expand:"right",collapse:"left"}}},k._icons["halo-theme"]=k._icons["elf-theme-halo"],k._icons["solar-theme"]=k._icons["elf-theme-solar"],k.getElfVersion=function(){if(!k._elfVersion){var e=0;if(window.EFX_GRID){var t=window.EFX_GRID.version;e=+(t=t.split("."))[0]}else if(window.elf)if(window.elf.version){var o=window.elf.version.match(/\d/);o&&o[0]&&(e=parseInt(o[0],10))}else window.elf.customElements?e=3:window.customElements&&(e=4);else window.Polymer&&(e=1);k._elfVersion=e}return k._elfVersion},k.hasComponent=function(e){var t=k._components[e];if(null==t){t=0;var o=k.getElfVersion();if(e)1===o?document.createElement(e).is===e&&(t=o):o>1&&(window.customElements&&window.customElements.get(e)||document.createElement(e).constructor!==HTMLElement)&&(t=o),k._components[e]=t}return t},k.toLangString=function(e){if(!e)return"";if("zh-hant"===(e=e.toLowerCase()))return"zh-Hant";var t=e.replace(/-.*/,"");return w[t]?t:""},k.hasTheme=function(e){return e===k.getThemeName()},k.getThemeName=function(e){return k._themeName||(k._themeName=k.getCssVariable("--theme-name",document.documentElement)),k._themeName},k.setThemeName=function(e){k._themeName=e},k.isThemeLoaded=function(){return k._themeLoaded},k.getColors=function(){return k.themeColors},k.isHaloTheme=function(e){return null==e&&(e=k.getThemeName()),!!e&&e.indexOf("halo")>=0},k.injectIcons=function(e,t){if("object"==typeof e){var o=k.getThemeName();e.themeName=o;var n=k.getElfVersion();e.elfVersion=n;var i=k._icons[o];i&&(e.icons=i)}},k.getIconList=function(){var e=k._icons[k.getThemeName()];return e?g(e):[]},k._onIconPreloaded=function(){if(k._dummyIcon){var e=k._dummyIcon.parentNode;e&&e.removeChild(k._dummyIcon),k._dummyIcon=null}},k.prepareIconPreloading=function(){if(!k._iconLoaded){k._iconLoaded=!0;var e=k.getIconList();if(e.length){setTimeout(k._onIconPreloaded,10);var t=k._dummyIcon=document.createElement("coral-icon");return t.style.transform="scale(0)",document.body.appendChild(t),e}}return null},k.getCssVariable=function(e,t){var o="",n=t||document.body;return window&&"string"==typeof e&&1===n.nodeType&&e.match(/^--/)&&(o=(o=window.getComputedStyle(n).getPropertyValue(e)).replace(/[\"\']/g,"")),o},k.getCssVariables=function(e,t){var o=t||document.body;if(window&&1===o.nodeType){var n=window.getComputedStyle(o);for(var i in e){var r=e[i];r&&r.match(/^--/)&&(e[i]=n.getPropertyValue(r).replace(/\"/g,""))}}return e||null},k.setRTK=function(e){null!=e&&(k._rtk=e)},k.getMovementColorProfile=function(){return document.documentElement.getAttribute("movement-color-profile")},k._addThemeChangedCallback=function(e){var t=k._callbacks;t.indexOf(e)<0&&t.push(e)},k.reloadThemeColors=function(){return k._deferred&&k._deferred.isFulfilled()?(k._profileName="",k._themeLoaded=!1,k.themeReady=null,k.getThemeColors()):k.themeReady},k.getThemeColors=function(e){if("function"==typeof e&&k._addThemeChangedCallback(e),k.themeReady)return k.themeReady;var t=k._deferred=new r;k.themeReady=t.promise;var o=k.getMovementColorProfile();if(o)o!==k._profileName?setTimeout(k._profileNameRetrieved,100):k._deferred.resolve(k.themeColors);else{var n={providerName:"Configuration",settingName:"RDE_USER_CURRENT_TICK_COLOR"},i=window?window.JET:null;if(k._themeLoaded=!1,k._rtk&&k._rtk.Settings)k._rtk.Settings.getAsync(n).then(k._loadingProfileSuccess).catch(k._loadingProfileFailure);else if(i&&i.Settings)try{i.Settings.read(k._loadingProfileSuccess,n)}catch(e){k._loadingProfileFailure()}else setTimeout(k._profileNameRetrieved,100)}return t.promise};var D=function(e){if(e!==k._profileName){k._retrieveThemeColors(e),k._pendingResolve&&(k._pendingResolve=!1,k._deferred.resolve(k.themeColors));for(var t=k._callbacks,o=0;o<t.length;o++)t[o]()}};k._loadingProfileSuccess=function(e){e&&document.documentElement.setAttribute("movement-color-profile",e.toLowerCase()),k._observed?k._pendingResolve=!0:k._profileNameRetrieved(e)},k._loadingProfileFailure=function(){k._retrieveThemeColors(),k._observed||(k._observed=!0,y.addAttributeListener(document.documentElement,D,"movement-color-profile")),k._deferred.reject("Failed to get movement color profile from settings.")},k._profileNameRetrieved=function(){var e=k.getMovementColorProfile();k._retrieveThemeColors(e),k._observed||(k._observed=!0,y.addAttributeListener(document.documentElement,D,"movement-color-profile")),k._deferred.resolve(k.themeColors)},k._retrieveThemeColors=function(e){k._themeLoaded=!0,k._profileName=e;var t=k.themeColors=k.getCssVariables({primary:"--color-scheme-primary",secondary:"--color-scheme-secondary",tertiary:"--color-scheme-tertiary",complementary:"--color-scheme-complementary",up:"--color-scheme-positive",down:"--color-scheme-negative",level:"--color-scheme-neutral",tickUp:"--color-scheme-tickup",tickDown:"--color-scheme-tickdown"});t.up||(t.up=k._defaultColors.up,t.down=k._defaultColors.down,t.level=k._defaultColors.level,t.tickUp=k._defaultColors.tickUp,t.tickDown=k._defaultColors.tickDown),t.positive=t.up,t.negative=t.down,t.neutral=t.level;var o=document.createElement("table");o.style.visibility="hidden",o.style.position="fixed",o.style.left="0",o.style.top="0",o.style.width="0";var n=o.insertRow(-1),i=n.insertCell(-1);document.body.appendChild(o);var r=window.getComputedStyle(n);t.tableBg=r.backgroundColor;var l=window.getComputedStyle(i);t.tableText=l.color,t.tableBorder=l.borderColor,t.tableText===t.tableBorder&&(i.className="tr-lg",l=window.getComputedStyle(i),t.tableBg=l.backgroundColor,t.tableText=l.color,t.tableBorder=l.borderColor,t.tableText===t.tableBorder&&(t.tableBg=k._defaultColors.baseGrid,t.tableText=k._defaultColors.baseText,t.tableBorder="")),t.tableBg=m(t.tableBg),t.tableText=m(t.tableText),t.tableBorder=m(t.tableBorder),document.body.removeChild(o),t.baseGrid=t.tableBg,t.baseText=t.tableText,t.trackColor=t.primary||k._defaultColors.trackColor};var N={"||":1,"&&":2,"<":3,">":3,"<=":3,">=":3,"!=":3,"=":3,"==":3,"===":3,"+":4,"-":4,"*":5,"%":6,"/":6},S={"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},"==":function(e,t){return e==t},"!=":function(e,t){return e!=t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t}},x=function(e,t,o,n){var i={value:t,type:o};return n&&(i.dataType=n),"operator"===o&&(i.precedence=N[t]),e.push(i),e.length-1},R={_tokens:[],_withString:function(e){return" #"+x(R._tokens,e.substring(1,e.length-1),"literal","string")+"#"},_withField:function(e){return" #"+x(R._tokens,e,"literal","variable")+"#"},_withFieldInBrackets:function(e){return R._withField(e.substring(1,e.length-1))},_withNegativeNumber:function(e){var t=+e;return t==t?" #"+x(R._tokens,t,"literal","number")+"#":""},_withPositiveNumber:function(e){return 35===e.charCodeAt(0)?e:R._withNegativeNumber(e)},_withOperator:function(e){return N[e]?("="!=e&&"==="!=e||(e="=="),"#"+x(R._tokens,e,"operator")+"#"):""},_withParenthesis:function(e){return"#"+x(R._tokens,e,"parenthesis")+"#"},_tester:function(e){for(var t=e._rpn,o=t.length,n=0,i=0,r=0;r<o;++r){if("literal"!==t[r].type){if(!(n>=2))return console.warn("Cannot parse an expression with insufficient number of operands"),!0;n-=2}++n>i&&(i=n)}return 1!==n||(e._stackSize=i,!1)},_filter:function(e,t){for(var o,n=e._rpn,i=new Array(e._stackSize),r=n.length,l=0,s=0;s<r;++s){var a=n[s],u=a.value;"literal"===a.type?o="variable"!==a.dataType?u:t?t[u]:null:(o=S[u](i[l-2],i[l-1]),l-=2),i[l++]=o}return!!i[0]},parse:function(e){if("function"==typeof e)return e;if(!e||"string"!=typeof e)return null;var t=e.trim();if(!t)return null;R._tokens.length=0,t=(t=(t=(t=(t=(t=(t=(t=t.replace(/".+?"/g,R._withString)).replace(/'.+?'/g,R._withString)).replace(/\[.+?\]/g,R._withFieldInBrackets)).replace(/-[0-9.]+/g,R._withNegativeNumber)).replace(/[0-9.#]+/g,R._withPositiveNumber)).replace(/[a-zA-Z_]\w*/g,R._withField)).replace(/[\-\/+*%!=<>&|]+/g,R._withOperator)).replace(/[()]/g,R._withParenthesis);var o=R._tokens,n=o.length;if(!n)return null;var i,r,l,s=[],a=t.match(/#[0-9]+#/g);for(i=0;i<n;++i){var u=a[i];if("literal"===(l=(r=o[+u.substring(1,u.length-1)]).type)){var d=s[s.length-1];if(d&&"literal"===d.type){if(!(r.value<0&&"number"===r.dataType))return console.warn("Cannot parse an expression with insufficient number of operators"),null;x(s,"-","operator"),r.value*=-1}}s.push(r)}R._tokens.length=0,n=s.length;var c=[],p=[],f=null,h=!1;for(i=0;i<n;++i)if("literal"===(l=(r=s[i]).type))c.push(r);else if("parenthesis"===l)if("("===r.value)p.push(r);else{for(h=!1;p.length;){if("("===(f=p.pop()).value&&"parenthesis"===f.type){h=!0;break}c.push(f)}h||console.warn("No left parenthesis paired with the right one")}else{var _=(f=p[p.length-1])?f.precedence:null;null!=_&&r.precedence<=_&&c.push(p.pop()),p.push(r)}for(h=!1;p.length;)"("===(f=p.pop()).value&&"parenthesis"===f.type?h=!0:c.push(f);if(h&&console.warn("No right parenthesis paired with the left one"),!c.length)return null;var g={_rpn:c};return R._tester(g)?null:R._filter.bind(null,g)}},F=function(){this._conditions=[],this._scopes=[],F._painters.push(this)};F.ColoringTypes={TEXT:1,HEATMAP:2,CONDITIONAL:3},F.prototype._coloringType=0,F.prototype._conditions=null,F.prototype._effectiveStyles=null,F.prototype._blinkCondition=null,F.prototype._scopes,F.prototype._columnStats=null,F.prototype._levelColorDisabled=!1,F._runningBlinkId=0,F._blinkingDuration=250,F._painters=[],F._emptyAry=[],F._emptyObj={},F._bgObj={backgroundColor:"",color:""},F._colorObj={color:""},F.bgStyles=["backgroundColor","color"],F.nonBgStyles=["fontSize","fontWeight","fontStyle","textAlign","textDecoration"],F.supportedStyles=F.bgStyles.concat(F.nonBgStyles),F.themeReady=null,F.parse=R.parse,F.prototype.dispose=function(){var e=F._painters.indexOf(this);e>=0&&F._painters.splice(e,1),this.reset(),this._conditions=null,this._scopes.length=0,this._blinkCondition=null},F.prototype.reset=function(){this._setColoringType(0);var e=this._scopes.length;if(e){for(var t=0;t<e;++t){var o=this._scopes[t];F._clearBlinkTimer(o)&&o._restorer();var n=o.cell;n&&delete n.blinking,o.cell=null}this._scopes.length=0}this._blinkCondition=null},F.prototype.resetColoring=function(){this._setColoringType(0),this._effectiveStyles=null,this._conditions.length=0},F.prototype.resetBlinking=function(){this._blinkCondition=null,this._scopes.length=0},F.prototype.clearBlinking=function(){this._blinkCondition=null;var e=this._scopes.length;if(e){for(var t=0;t<e;++t){var o=this._scopes[t];F._clearBlinkTimer(o)&&o._restorer();var n=o.cell;n&&delete n.blinking,o.cell=null}this._scopes.length=0}},F.prototype.resetHeatMap=function(){this._conditions.length=0,this._columnStats=null},F.prototype.clearHeatMap=function(){return this._blinkCondition?(this._setColoringType(0),this.resetHeatMap(),!1):(this.dispose(),!0)},F.prototype.applyThemeColor=function(){var e=k.getColors();if(this._coloringType===F.ColoringTypes.HEATMAP){var t=this._conditions[0];if(t&&(t.textMode?t.baseColor=e.baseText:t.baseColor=e.baseGrid,t.useThemeColor)){var o=e.up,n=e.down,i=e.level===e.baseText?"":e.level;F._setUpDownColors(t,o,n,i)}}this._blinkCondition&&this._blinkCondition.useThemeColor&&F._setUpDownColors(this._blinkCondition,e.up,e.down,e.level,!0)},F.prototype.getConditions=function(){return this._conditions},F.prototype.getColoringType=function(){return this._coloringType},F.prototype._setColoringType=function(e){this._coloringType!==e&&(this._coloringType=e)},F.prototype.setEffectiveStyles=function(e){this._effectiveStyles=e},F.prototype.getEffectiveStyles=function(){return this._effectiveStyles},F.prototype.setConditions=function(e){this._conditions.length=0,this._setColoringType(F.ColoringTypes.CONDITIONAL);for(var t=e.length,o=0;o<t;o++)this._addCondition(e[o])},F.prototype.setColumnStats=function(e){this._columnStats=e&&e.getMin?e:null},F.prototype.getColumnStats=function(){return this._columnStats},F.prototype._addCondition=function(e){var t=e.expression;t&&(e._fn=R.parse(t.text||t),this._conditions.push(e))},F.prototype.addHeatmap=function(e,t,o,n,i,r){this._setColoringType(F.ColoringTypes.HEATMAP);var l={heatmap:!0};return l.field=e,l.expression=F._heatMapCondition.bind(l),l.midPoint=t,F._setUpDownColors(l,o,n),l.baseColor=i,!0!==r&&"text"!==r||(l.textMode=!0),this._addCondition(l),l},F.prototype.addHeatmapWithTheme=function(e,t,o){var n=k.themeColors,i=this.addHeatmap(e,t,n.up,n.down,n.baseGrid,o);return!0!==o&&"text"!==o||(i.baseColor=n.baseText),i.useThemeColor=!0,i},F.prototype._addColorText=function(e,t,o,n,i){this._setColoringType(F.ColoringTypes.TEXT);var r={};return r.field=t,r.expression=e.bind(null,t),r.upClass=o,r.downClass=n,r.levelClass=i,this._addCondition(r),r},F.prototype.addColorText=function(e,t,o,n){return this._addColorText(C[e]?F._tickColorTextCondition:F._colorTextCondition,e,t,o,n)},F.prototype.addColorTextWithTheme=function(e){return this.addColorText(e,"positive","negative","neutral")},F.prototype.addTickColorText=function(e,t,o){return this.addColorText("CF_TICK",e,t,o)},F.prototype.addTickColorTextWithTheme=function(){var e=k.themeColors,t=this.addTickColorText(e.tickUp,e.tickDown,e.level);return t.useThemeColor=!0,t},F.prototype.addTickBlink=function(e,t,o,n){return this.addBlink("CF_TICK",e,t,o,n)},F.prototype.addTickBlinkWithTheme=function(e){var t=k.themeColors,o=this.addTickBlink(t.tickUp,t.tickDown,t.level,e);return o.useThemeColor=!0,o},F.prototype.addBlink=function(e,t,o,n,i){return this._addBlink(C[e]?F._tickBlinkCondition:F._fieldBlinkCondition,e,t,o,n,i)},F.prototype.addBlinkWithTheme=function(e,t){var o=k.themeColors,n=this.addBlink(e,o.up,o.down,o.level,t);return n.useThemeColor=!0,n},F.prototype._addBlink=function(e,t,o,n,i,r){var l=this._blinkCondition={};return l.blink=!0,l.blinkId=F._runningBlinkId++,l.field=t,l._fn=l.expression=e,!0!==r&&"border"!==r||(l.border=!0),F._setUpDownColors(l,o,n,i,!0),l},F.prototype.renderForPrinting=function(e,t,o,n){if(e){var i=this._getStyles(t,o,n),r=i.cssClass;null!=r?(elem._coloringCssClass&&elem._coloringCssClass!==r&&(elem.classList.remove(elem._coloringCssClass),elem._coloringCssClass=null),r&&(elem.classList.add(r),elem._coloringCssClass=r)):(e._coloringCssClass&&(e.classList.remove(e._coloringCssClass),e._coloringCssClass=null),e.style.backgroundColor=i.backgroundColor||"",e.style.color=i.color||"")}},F._colorTextCondition=function(e,t){var o=t[e];if(o||0===o){if(o>0)return 1;if(o<0)return-1}return"u"},F._tickColorTextCondition=function(e,t){var o=v[t[e]];if(o)return o},F._heatMapCondition=function(e,t,o){var n=e[this.field],i=n||0===n?n-this.midPoint:NaN;if(0===i||i!=i)return 0;var r=1;return i>0?(r=o-this.midPoint)<0&&(r=t-this.midPoint):(r=t-this.midPoint)>0&&(r=o-this.midPoint),r<0&&(r=-r),i/r},F._tickBlinkCondition=function(e){var t=v[e];if(t)return t},F._fieldBlinkCondition=function(e,t){return e>t?1:e<t?-1:0},F._borderRestorer=function(e){e.blinkTimer=0;var t=e.cell.getElement();t&&(t.style.border="")},F._cellRestorer=function(e){e.blinkTimer=0;var t=e.cell.getElement();if(t){var o=e.rowData,n=NaN,i=NaN;if(this._coloringType===F.ColoringTypes.HEATMAP){var r=this._columnStats;r&&(n=r.getMin(),i=r.getMax())}var l=this._getStyles(o,n,i),s=l.cssClass;null!=s?(t._coloringCssClass&&t._coloringCssClass!==s&&(t.classList.remove(t._coloringCssClass),t._coloringCssClass=null),s&&(t.classList.add(s),t._coloringCssClass=s),t.style.backgroundColor="",t.style.color=""):(t._coloringCssClass&&(t.classList.remove(t._coloringCssClass),t._coloringCssClass=null),t.style.backgroundColor=l.backgroundColor||"",t.style.color=l.color||"")}},F.prototype._getStyles=function(e,t,o){if(!e)return F._emptyObj;for(var n=this._conditions.length,i=0;i<n;++i){var r,l=this._conditions[i],s=l._fn;try{var a=s&&s(e,t,o)}catch(e){}if(a)return this._coloringType===F.ColoringTypes.HEATMAP?(r=a>0?F.blendColor(l.baseColor,l.upColor,a):F.blendColor(l.baseColor,l.downColor,-a),l.textMode?(F._colorObj.color=F.num2Hex(r),F._colorObj):(F._bgObj.backgroundColor=F.num2Hex(r),F._bgObj.color=F.blackAndWhite(r),F._bgObj)):this._coloringType===F.ColoringTypes.TEXT?(l.cssClass=a>0?l.upClass:a<0?l.downClass:this._levelColorDisabled?"":l.levelClass,l.cssClass=l.cssClass||"",l):l}return F._emptyObj},F.blendColor=function(e,t,o){o>1?o=1:o<0&&(o=0);for(var n=F.hex2Num(e),i=F.hex2Num(t),r=[],l=0;l<3;++l){var s=(i[l]-n[l])*o;r.push(n[l]+s)}return r},F.blackAndWhite=function(e){return Math.sqrt(e[0]*e[0]*.241+e[1]*e[1]*.691+e[2]*e[2]*.068)>=135?"#000000":"#FFFFFF"},F.rgb2Hex=m,F.num2Hex=function(e){return"#"+(16777216+(e[2]|e[1]<<8|e[0]<<16)).toString(16).slice(1)},F.num2Rgb=function(e){return"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},F.hex2Num=function(e){var t=parseInt(e.replace(/[^0-9A-F]/gi,""),16);return[t>>16&255,t>>8&255,255&t]},F.hex2Rgb=function(e){if(e){var t=parseInt(e.replace(/[^0-9A-F]/gi,""),16);return"rgb("+(t>>16&255)+", "+(t>>8&255)+", "+(255&t)+")"}return""},F.themeChanged=function(){},F.setThemeColors=function(){},F._onThemeChanged=function(){for(var e=F._painters,t=e.length;--t>=0;)e[t].applyThemeColor()},F.loadThemeColors=function(){return F.themeReady||(F.themeReady=k.getThemeColors(F._onThemeChanged).then(F._onThemeChanged).catch(F._onThemeChanged)),F.themeReady},F.reloadThemeColors=function(){return F.themeReady=k.reloadThemeColors().then(F._onThemeChanged).catch(F._onThemeChanged),F.themeReady},F.clearCellStyle=function(e,t){var o=e.getElement();if(o){var n=e.blinking;if(n&&(F._clearBlinkTimer(n),delete e.blinking,n.cell=null),o._coloringCssClass&&o.classList.remove(o._coloringCssClass),t||(t=F.supportedStyles),Array.isArray(t))for(var i=t.length;--i>=0;)o.style[t[i]]="";else for(var r in t)o.style[r]=""}},F._setUpDownColors=function(e,t,o,n,i){e.upColor=t,null!=t&&i&&(e.contrastUpColor=F.getOppositeColor(t)),e.downColor=o,null!=o&&i&&(e.contrastDownColor=F.getOppositeColor(o)),e.levelColor=n,null!=n&&i&&(e.contrastLevelColor=F.getOppositeColor(n))},F._clearBlinkTimer=function(e,t){return!!e.blinkTimer&&(clearTimeout(e.blinkTimer),e.blinkTimer=0,!0)},F.getOppositeColor=function(e){if("string"==typeof e){if("#"===e.charAt(0)){var t=F.hex2Num(e);return F.blackAndWhite(t)}}else if(Array.isArray(e))return F.blackAndWhite(e);return""},F.prototype.render=function(e,t,o,n,i){null!=o&&o==o?this._paintCell(e,t,o,n):this._conditions.length&&this._coloringType===F.ColoringTypes.CONDITIONAL&&this._paintCell(e,t)},F.prototype.renderHeatMap=function(e,t,o,n){this._paintCell(e,t,o,n)},F.prototype.renderColoring=function(e,t){this._paintCell(e,t)},F.prototype._paintCell=function(e,t,o,n){if(e){var i=e.getElement();if(i){var r,l=this._blinkCondition;if(!(l&&(r=e.blinking)&&r.blinkTimer)||l.border){var s=this._getStyles(t,o,n),a=i.style,u=s.cssClass;i._coloringCssClass&&i._coloringCssClass!==u&&(i.classList.remove(i._coloringCssClass),i._coloringCssClass=null),null!=u?u&&(i.classList.add(u),i._coloringCssClass=u):(s.backgroundColor?a.backgroundColor=s.backgroundColor:this._effectiveStyles&&!this._effectiveStyles.backgroundColor||(a.backgroundColor=""),s.color?a.color=s.color:this._effectiveStyles&&!this._effectiveStyles.color||(a.color=""))}}}},F.prototype.blink=function(e,t,o){this._blinkCell(e,o,t)},F.prototype.blinkCell=function(e,t,o,n){if(!this._blinkCondition)return!1;var i=this._blinkCondition._fn(t,o);return this._blinkCell(e,n,i)},F.prototype._blinkCell=function(e,t,o){if(!e)return!1;if(this._levelColorDisabled&&!o)return!1;var n=e.getElement();if(!n)return!1;var i=this._blinkCondition;if(!i)return!1;var r,l,s=e.blinking;if(s||((s={}).cell=e,e.blinking=s,this._scopes.push(s)),s.blinkId!==i.blinkId){s.blinkId=i.blinkId,s.field=i.field;var a=i.border?F._borderRestorer:F._cellRestorer;s._restorer=a.bind(this,s)}s.rowData=t,o>0?(r=i.upColor,l=i.contrastUpColor):o<0?(r=i.downColor,l=i.contrastDownColor):(r=i.levelColor,l=i.contrastLevelColor);var u=!0;return i.border?(n.style.border="1px solid "+r,u=!1):(n.style.backgroundColor=r,n.style.color=l),F._clearBlinkTimer(s),s.blinkTimer=setTimeout(s._restorer,F._blinkingDuration),u},F.prototype.verifyBlinking=function(e,t){var o=e.blinking;o&&o.blinkTimer&&o.rowData!==t&&(o.rowData=t,F._clearBlinkTimer(o)&&o._restorer())},F.prototype.disableLevelColor=function(e){this._levelColorDisabled=!1!==e};var A={EQ:{id:"EQ",name:"Equal to",type:"string",positive:1,caseSensitive:1,formula:"str == input"},NEQ:{id:"NEQ",name:"Not equal to",type:"string",positive:0,caseSensitive:1,formula:"str != input"},NUMEQ:{id:"NUMEQ",name:"Number equal to",type:"number",positive:1,caseSensitive:1,formula:"val == input"},NUMNEQ:{id:"NUMNEQ",name:"Number not equal to",type:"number",positive:0,caseSensitive:1,formula:"val != input"},GT:{id:"GT",name:"Greater than",type:"number",positive:1,caseSensitive:1,formula:"val > input"},GTE:{id:"GTE",name:"Greater than or equal to",type:"number",positive:1,caseSensitive:1,formula:"val >= input"},LT:{id:"LT",name:"Less than",type:"number",positive:1,caseSensitive:1,formula:"val < input"},LTE:{id:"LTE",name:"Less than or equal to",type:"number",positive:1,caseSensitive:1,formula:"val <= input"},BEGIN:{id:"BEGIN",name:"Begin with",type:"string",positive:1,caseSensitive:0,formula:"str.indexOf(input) === 0"},NBEGIN:{id:"NBEGIN",name:"Not begin with",type:"string",positive:0,caseSensitive:0,formula:"str.indexOf(input) !== 0"},END:{id:"END",name:"End with",type:"string",positive:1,caseSensitive:0,formula:"(str.length >= input.length) && str.lastIndexOf(input) === (str.length - input.length)"},NEND:{id:"NEND",name:"Not end with",type:"string",positive:0,caseSensitive:0,formula:"(str.length < input.length) || str.lastIndexOf(input) !== (str.length - input.length)"},CONT:{id:"CONT",name:"Contain",type:"string",positive:1,caseSensitive:0,formula:"str.indexOf(input) >= 0"},NCONT:{id:"NCONT",name:"Not contain",type:"string",positive:0,caseSensitive:0,formula:"str.indexOf(input) < 0"},EQ_BLANK:{id:"EQ_BLANK",name:"Equal to blank value",type:"blank",positive:1,caseSensitive:1,formula:"!val && val !== 0"},EQ_NBLANK:{id:"EQ_NBLANK",name:"Equal to non blank value",type:"blank",positive:1,caseSensitive:1,formula:"(val || val === 0) ? true : false"},DT:{id:"DT",name:"Date is",type:"date",positive:1,caseSensitive:1,formula:"ts === input"},DTA:{id:"DTA",name:"Date is After",type:"date",positive:1,caseSensitive:1,formula:"ts > input"},DTB:{id:"DTB",name:"Date is Before",type:"date",positive:1,caseSensitive:1,formula:"ts < input"}};A.TXTEQ=A.EQ,A.BLANK=A.EQ_BLANK,A.NBLANK=A.EQ_NBLANK;var E={EQ:function(e,t){return e==t},NEQ:function(e,t){return e!=t},NUMEQ:function(e,t){return e==t},NUMNEQ:function(e,t){return e!=t},GT:function(e,t){return e>t},GTE:function(e,t){return e>=t},LT:function(e,t){return e<t},LTE:function(e,t){return e<=t},BEGIN:function(e,t){return 0===e.indexOf(t)},NBEGIN:function(e,t){return 0!==e.indexOf(t)},END:function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},NEND:function(e,t){return e.length<t.length||e.lastIndexOf(t)!==e.length-t.length},CONT:function(e,t){return e.indexOf(t)>=0},NCONT:function(e,t){return e.indexOf(t)<0},EQ_BLANK:function(e,t){return!e&&0!==e},EQ_NBLANK:function(e,t){return!(!e&&0!==e)},DT:function(e,t){return e===t},DTA:function(e,t){return e>t},DTB:function(e,t){return e<t}},I={or:1,OR:1,Or:1,oR:1,"||":1},G=function(e){return"number"==typeof e?e:e?Number(e):!1===e?0:NaN},O=function(e){return"string"==typeof e?e:e?e+"":0===e?"0":!1===e?"false":""},B=function(e,t){return e&&e.getTime?t?1e4*e.getUTCFullYear()+100*e.getUTCMonth()+e.getUTCDate():1e4*e.getFullYear()+100*e.getMonth()+e.getDate():NaN},P=function(e,t){var o=e._conds,n=o?o.length:0;if(!n)return!0;var i,r,l,s=e._fieldName,a=e._formattedFieldName,u=t[s];e._rawDataAccessor&&(u=e._rawDataAccessor(u));for(var d=!1,c=!1,p=0;p<n;++p){var f=0;if(p>0)if(f=I[o[p-1].connector]){if(d)return!0}else if(!d)continue;var h=o[p],_=A[h.operatorId];c=!1;var g=_.type,m=_.id,v=E[m];"blank"===g?c=v(u):"number"===g?(null==r&&(r=G(u)),c=v(r,h.value)):"date"===g?(null==l&&(l=B(u,!1)),c=v(l,h.value)):(null==i&&(e._formattedDataAccessor?i=e._formattedDataAccessor(t[s]):e._formatter?i=e._formatter(t):a!==s?null==(i=t[a])&&(i=u):i=u,i=O(i),_.caseSensitive||(i=i.toLowerCase())),c=v(i,h.value)),d=p>0?f?d||c:d&&c:c}return d},L=function(e,t){var o=t[e._fieldName];return e._rawDataAccessor&&(o=e._rawDataAccessor(o)),!!e._itemMap[o]},U=function(e){return[e.operatorId,e.origValue,e.connector]},j=function(e){this._initStaticVariables(),this._conditions=[],this.init(e)};j.prototype._initStaticVariables=function(){if(!j._initStatic){j._initStatic=!0,j._updateTimezoneOffset();var e=864e5-new Date%864e5;setTimeout(j._setUpdateInterval,e)}},j._initStatic=!1,j.prototype._fieldName="",j.prototype._formattedFieldName="",j.prototype._formatter=null,j.prototype._useUTCTime=!1,j.prototype._rawDataAccessor=null,j.prototype._formattedDataAccessor=null,j.prototype._conditions,j._timezoneOffset=0,j._updateTimezoneOffset=function(){j._timezoneOffset=60*(new Date).getTimezoneOffset()},j._setUpdateInterval=function(){j._updateTimezoneOffset(),setInterval(j._updateTimezoneOffset,864e5)},j.prototype.reset=function(){this.setFieldDefinition(""),this._rawDataAccessor=this._formattedDataAccessor=null},j.prototype.init=function(e){if(e){var t=e.field;t?this.setFieldDefinition(t,e.formatter,e.formattedField):null!=t&&this.setFieldDefinition("");var o=e.useUTCTime;null!=o&&(this._useUTCTime=!!o);var n=e.rawDataAccessor,i=e.formattedDataAccessor;null==n&&null==i||this.setDataAccessors(n,i)}},j.prototype.setFieldDefinition=function(e,t,o){this._fieldName=e,this._formattedFieldName=o||this._fieldName+"_FORMATTED",this._formatter=t||null,this._conditions.length=0},j.prototype.setDefaultUTCUsage=function(e){this._useUTCTime=!!e},j.prototype.setDataAccessors=function(e,t){this._rawDataAccessor="function"==typeof e?e:null,this._formattedDataAccessor="function"==typeof t?t:null},j.prototype.addCondition=function(e,t,o,n){var i=e?e.toUpperCase():"",r=A[i];if(!r)return!1;if("{}"===t||"{*}"===t)i=r.positive^"{}"===t?"EQ_NBLANK":"EQ_BLANK",r=A[i];else if(!t&&"blank"!==r.type&&0!==t&&!1!==t)return!1;var l={operatorId:i,origValue:t,connector:o||""};return null!=n&&(l.useUTCTime=n),this._conditions.push(l),!0},j.prototype.addConditions=function(e){var t=0;if(Array.isArray(e)){for(var o=e.length,n=0;n<o;++n){var i=e[n];Array.isArray(i)&&this.addCondition(i[0],i[1],i[2],i[3])&&++t}o>1&&!t&&!Array.isArray(e[0])&&this.addCondition(e[0],e[1],e[2])&&++t}return t},j.prototype.getConditions=function(){return this._conditions.length?this._conditions.map(U):null},j.prototype.buildFilter=function(){if(!this._fieldName)return null;var e=this._conditions.length;if(!e)return null;for(var t=this._formatter,o=this._conditions.slice(),n=0;n<e;++n){var i=o[n],r=A[i.operatorId],l=r.type,s=i.origValue;if("number"===l)s=G(s);else if("date"===l){var a=null;s instanceof Date?a=s:"number"!=typeof s&&"string"!=typeof s||(a=new Date(s)),s=B(a,null!=i.useUTCTime?i.useUTCTime:this._useUTCTime)}else if("string"===l){if(t){var u={};u[fieldName]=inputStr,u[fmtFieldName]=inputStr,s=t(u)}s=O(s),r.caseSensitive||(s=s.toLowerCase())}i.value=s}var d={_conds:o,_fieldName:this._fieldName||"",_formatter:t||null,_formattedFieldName:this._formattedFieldName||"",_rawDataAccessor:this._rawDataAccessor||null,_formattedDataAccessor:this._formattedDataAccessor||null};return this._conditions.length=0,P.bind(null,d)},j.prototype.buildMonitorFilter=function(e,t,o,n){this.setFieldDefinition(t,o,n);for(var i=t.lastIndexOf("_LOCAL")===t.length-6,r=e.split("♣"),l=0;l<r.length;l++){var s=r[l].split("♦");i&&(s[1]=(s[1]-j._timezoneOffset)%86400+""),this.addCondition(s[0],s[1],s[2])}return this.buildFilter()};j.prototype.parse=function(e,t,o,n,i,r){var l=typeof e;return"string"===l?e.indexOf("♦")>=0?this.buildMonitorFilter(e,t,o,n):R.parse(e):"function"===l?e:Array.isArray(e)?(t&&(this.setFieldDefinition(t,o,n),this.setDataAccessors(i,r)),this.addConditions(e),this.buildFilter()):"object"===l?function(e,t,o){if(!e||!t)return null;var n={_fieldName:t,_itemMap:e};return o&&(n._rawDataAccessor=o),L.bind(null,n)}(e,t,i):null};var M={backgroundColor:1},H={color:1},z={backgroundColor:1,color:1},V=/\[[^\[\]]*\]/g,W=function(e){var t=[];if(e&&"string"==typeof e)for(var o=e.match(V),n=0;n<o.length;n++)t.push(o[n].replace(/[\[\]]/g,""));return t},K=function(){this._onSectionBinding=this._onSectionBinding.bind(this),this._onColumnAdded=this._onColumnAdded.bind(this),this._onColumnRemoved=this._onColumnRemoved.bind(this),this._onThemeLoaded=this._onThemeLoaded.bind(this),K.cleanUpPrevRows=K.cleanUpPrevRows.bind(this),K._cleanUpPrevFields=K._cleanUpPrevFields.bind(this),this._hosts=[]};n.inherits(K,l),K._cleanUpTimer=0,K._controlClass="predefined-conditional-color",K._colorTextStyles,K.prototype._blinkingEnabled=!1,K.prototype._pendingFields,K.prototype._predefinedColors=null,K._predefinedColorsStyles,K.prototype.getName=function(){return"ConditionalColoringPlugin"},K.prototype.hasMultiTableSupport=function(){return!0},K.prototype.initialize=function(e,t){e._prevDataRows={};var o=this._hosts;if(!(o.indexOf(e)>=0)){o.push(e);var n=t.conditionalColoring;if(n){var i=n.predefinedColors;null!=i&&"object"==typeof i&&(this._predefinedColors||(this._predefinedColors=i,this._predefinedColorsStyles=this._prepareStyles(i)),this._injectPredefinedColors(e),e.enableClass(K._controlClass))}1===o.length?this.config(t):(this._applyStyle(e,t),this._injectColorTextStyles()),e.listen("postSectionDataBinding",this._onSectionBinding),e.listen("columnAdded",this._onColumnAdded),e.listen("columnRemoved",this._onColumnRemoved),F.themeReady||F.loadThemeColors().then(this._onThemeLoaded).catch(this._onThemeLoaded),k.getThemeColors(this._onThemeLoaded)}},K.prototype._afterInit=function(){var e=this._pendingFields;if(e){for(var t,o,n,i=0;i<e.length;i++)t=e[i][0],o=e[i][1],n=e[i][2],this._addDataFields(t,o,n);this._pendingFields=null}},K.prototype.unload=function(e){var t=this._hosts.indexOf(e);t<0||(this._hosts.splice(t,1),e.unlisten("postSectionDataBinding",this._onSectionBinding),e.unlisten("columnAdded",this._onColumnAdded),e.unlisten("columnRemoved",this._onColumnRemoved),e._prevDataRows=null,this._dispose())},K.prototype.beforeProcessOption=function(e,t){if("blinker"==e)return null},K.prototype.config=function(e){if(e){var t=e.columns;if(t)for(var o=t.length,n=0;n<o;++n)this.setColumnColoring(n,t[n])}},K.prototype.getConfigObject=function(e){var t=e||{};if(null!=this._predefinedColors){var o=t.conditionalColoring;o||(o=t.conditionalColoring={}),o.predefinedColors=this._predefinedColors}var n=t.columns;n||(n=t.columns=[]);for(var i=this.getColumnCount(),r=0;r<i;++r){var l=n[r];l||(l=n[r]={}),this.getColumnColoring(r,l)}return t},K.prototype.getColumnColoring=function(e,t){t||(t={});var o=this._hosts[0],n=this._getColumnOption(e,"conditions",o);if(Array.isArray(n)&&n.length>0){t.conditions=[];for(var i=n.length,r=0;r<i;r++){var l={};c(l,n[r],["expression","backgroundColor","color","cssClass"]),t.conditions.push(l)}}var s=this._getColumnOption(e,"colorText",o);s&&(t.colorText=s);var a=this._getColumnOption(e,"tickColor",o);a&&(t.tickColor=a);var u=this._getColumnOption(e,"blinking",o);u&&(t.blinking=u);var d=this._getField(e);return d&&(t.field=d),t},K.prototype._applyStyle=function(e,t){if(t){var o=t.columns;if(o)for(var n,i=o.length,r=0;r<i;++r)n=this.getColumnPainter(r),this._isValidPainter(n)&&e.enableColumnClass(r,"conditionally-colored",!0)}},K.prototype._enableColumnStyle=function(e,t){t=!1!==t;for(var o=this._hosts,n=o.length;--n>=0;)o[n].enableColumnClass(e,"conditionally-colored",t)},K.prototype._isValidPainter=function(e){return!!e&&e.getColoringType()!==F.ColoringTypes.HEATMAP},K.prototype._clearCellStyles=function(e,t){var o,n,i,r,l,s=this._hosts;for(o=s.length;--o>=0;)for(i=(n=s[o].getSection("content")).getRowCount(),r=0;r<i;++r)(l=n.getCell(e,r,!1))&&F.clearCellStyle(l,t)},K.prototype._cachePreviousValue=function(){var e,t,o,n=this.getColumnCount(),i=this._hosts,r=i.length;for(e=0;e<r;e++)for(o=i[e],t=0;t<n;++t)this._cacheColumnPreviousValue(t,o)},K.prototype._cacheColumnPreviousValue=function(e,t){var o=t._prevDataRows||{},n=t.getDataSource(),i=n.getRowCount(),r=this._getColumnData(e);if(r.blinking){var l,s,a,u,d=r.blinkingField||this._getField(e);for(l=0;l<i;l++)s=n.getRowId(l),null!=(a=this._getData(n,l,d))&&((u=o[s])||(u=o[s]={}),u[d]=a);t._prevDataRows=o}},K.prototype._addDataFields=function(e,t,o){if(this._realTimeGrid&&e&&o){var n=null;if(null!=t){var i="object"==typeof t?t:this._realTimeGrid.getColumnDefinition(t);n=i?i.getId()+"_"+o:null}this._realTimeGrid.addDataFields(e,n)}},K.prototype._removeDataFields=function(e,t,o){if(this._realTimeGrid&&e&&o){var n=null;if(null!=t){var i="object"==typeof t?t:this._realTimeGrid.getColumnDefinition(t);n=i?i.getId()+"_"+o:null}this._realTimeGrid.removeDataFields(e,n)}},K.prototype._removeFieldReferrer=function(e,t){if(this._realTimeGrid&&t){var o=null;if(null!=e){var n=e;if("number"==typeof e){var i=this._realTimeGrid.getColumnDefinition(e);i&&(n=i.getId())}o=n?n+"_"+t:null,this._realTimeGrid.removeFieldReferrer(o)}}},K.prototype.setColumnColoring=function(e,t){var o,n;t&&(o=t.blinking,n=t.field),this.setColumnBlinking(e,o,n),this.setConditionalColoring(e,t);var i=this._newColumnData(e);!i.painter||i.coloringFields||i.blinkingField||this._clearPainter(i)},K.prototype.setConditionalColoring=function(e,t){var o=this._newColumnData(e);t?(o.conditions=t.conditions,o.colorText=t.colorText,o.tickColor=t.tickColor,o.field=t.field):(o.conditions=null,o.colorText=null,o.tickColor=null);var n=o.painter,i=o.coloringFields?Object.keys(o.coloringFields):null,r=this._prepareColorOptions(e,t);if(this._isValidPainter(n)){if(i){var l=n.getEffectiveStyles();this._clearCellStyles(e,l)}n.resetColoring()}if(r.hasColor){var s=r.fields;if(n){if(i){for(var a,u=[],d=0;d<i.length;d++)s[a=i[d]]||u.push(a);u.length&&this._removeDataFields(u,e,"coloring")}}else n=o.painter=new F;if(r.condColoring){var c=r.condColoring.conditions;n.setConditions(c),this._setEffectiveStyles(n,c)}else if(r.colorText){var p=r.colorText;if(p.useThemeColors){if(!K._colorTextStyles){K._colorTextStyles=this._prepareStyles({positive:{color:"var(--color-scheme-positive)"},negative:{color:"var(--color-scheme-negative)"},neutral:{color:"var(--color-scheme-neutral)"}})}this._injectColorTextStyles(),n.addColorTextWithTheme(r.colorText.field)}else n.addColorText(p.field,p.upClass,p.downClass,p.levelClass)}var f=Object.keys(s);this._initializedGrid?this._addDataFields(f,e,"coloring"):(this._pendingFields||(this._pendingFields=[]),this._pendingFields.push([f,e,"coloring"])),this._enableColumnStyle(e,!0),n.inputField=r.inputField,o.coloringFields=s}else i&&this._removeFieldReferrer(e,"coloring"),o.coloringFields=null,this._enableColumnStyle(e,!1);if(this._initializedGrid){var h=this._hosts[0];if(h){var _=h.getPlugin("RowColoringPlugin");_&&_.forceUpdateRowColor&&_.forceUpdateRowColor()}this._requestRowRefresh()}},K.prototype.setColumnBlinking=function(e,t,o){var n=this._newColumnData(e),i=n.blinkingField;n.blinking=t;var r=n.painter,l=this._prepareBlinkingOptions(e,t,o);if(l){var s=l.field;if(r?i&&(r.clearBlinking(),i!==s&&this._removeDataFields(i,e,"blinking")):n.painter=r=new F,r.disableLevelColor(!1===l.level),l.customColor?r.addBlink(s,l.up,l.down,l.level,l.border):r.addBlinkWithTheme(s,l.border),n.blinkingField=s,this._blinkingEnabled=!0,!i&&(this._compositeGrid||this._initializedGrid))for(var a,u=this._hosts,d=0;d<u.length;d++)a=u[d],this._cacheColumnPreviousValue(e,a);K._startCleanUpInterval(),this._initializedGrid?this._addDataFields(s,e,"blinking"):(this._pendingFields||(this._pendingFields=[]),this._pendingFields.push([s,e,"blinking"]))}else i&&(r&&(r.clearBlinking(),K._cleanUpPrevFields()),this._removeFieldReferrer(e,"blinking")),n.blinkingField=null},K.prototype.blinkRow=function(e,t,o){if(o=o||this._hosts[0]){var n=o.getDataSource();if(n){var i=o.getSection("content");if(i)for(var r=n.getRowDataAt(e),l=i.getColumnCount(),s=0;s<l;++s){var a=this.getColumnPainter(s);if(a){var u=i.getCell(s,e,!1);u&&a.blink(u,t,r)}}}}},K.prototype._prepareBlinkingOptions=function(e,t,o){if(null==e||!t)return null;var n={},i=o||this._getField(e),r=i;return"string"==typeof t?r=t:"object"==typeof t&&(r=t.field||i,n.border=t.border,(t.up||t.down||t.level)&&(n.customColor=!0,n.up=t.up,n.down=t.down,n.level=t.level),!1===t.level&&(n.level=!1)),n.field=K._convertKeyword(r,i),n.inputField=r,n},K.prototype._prepareColorOptions=function(e,t){var o={};if(!t)return o;var n=this._getField(e),i=t.field||n,r=t.inputField||"";o.inputField=r,i=K._convertKeyword(r,i);var l=t.colorText||t.tickColor,s=t.conditions,a=s?s.length:0;if(a){o.hasColor=1,o.fields={},o.condColoring={},o.condColoring.conditions=s;var u=i==n?t.textFormatter:null,d=K.getFilterBuilder();d.setFieldDefinition(i,u,i);for(var c=a;--c>=0;){var p=s[c],f=p.expression;if(!f&&i){var h=p.condition,_=p.value1,g=p.value1;"BTW"!==h?d.addCondition(h,_):(d.addCondition("GTE",_),d.addCondition("LTE",g)),f=d.buildFilter(),p.expression=f,o.fields[i]=!0}else for(var m=W(f),v=0;v<m.length;v++)o.fields[m[v]]=!0}}else if(l){o.hasColor=1,o.fields={},o.colorText={},o.colorText.useThemeColors=!0;var C=typeof l;"string"===C?i=l:"object"===C&&(i=l.field||i,(l.upClass||l.downClass||l.levelClass)&&(o.colorText.useThemeColors=!1,o.colorText.upClass=l.upClass,o.colorText.downClass=l.downClass,o.colorText.levelClass=l.levelClass)),o.colorText.field=i,o.fields[i]=!0}return o},K._convertKeyword=function(e,t){return e?e.indexOf("THIS_COLUMN")>-1?t:e:t},K._mapInsertedRowId=function(e){for(var t={},o=e?e.length:0,n=0;n<o;++n){var i=e[n];"inserted"===i.type&&(t[i.rid]=!0)}return t},K._mergeUpdates=function(e){var t,o,n=e.events,i=n?n.length:0,r=e.dataSource,l=[];for(o=0;o<i;++o)if("updated"===(t=n[o]).type){var s=r.getRowIndex(t.rid);l[s]||(l[s]={changed:{},rid:t.rid});var a=l[s].changed,u=t.changes;for(var d in u)a[d]=1}return l},K.prototype._prepareStyles=function(e){var t,o,n,i=".tr-grid."+K._controlClass+" .column.conditionally-colored .cell",r=[];for(var l in e)r.push(i+"."+l),t=[],(n=(o=e[l]).backgroundColor)&&t.push("background-color: "+n+";"),(n=o.color)&&t.push("color: "+n+";"),r.push(t);return function(e){if(e){var t="";if(Array.isArray(e))t=e.map(f).join("\n").replace(/{\s*{/g,"{").replace(/\s+{/g," {");else t="string"==typeof e?e:e+"";if(t)return t.replace(/{[\w\W]*?}/g,h)}return""}(r)},K.prototype._injectColorTextStyles=function(){if(K._colorTextStyles)for(var e=this._hosts,t=e.length,o=0;o<t;o++){var n=e[o];n.enableClass(K._controlClass),n._colorTextStyles||(_(K._colorTextStyles,n.getElement()),n._colorTextStyles=!0)}},K.prototype._injectPredefinedColors=function(e){e._conditionalColoringStyleTag&&(e._conditionalColoringStyleTag.parentNode.removeChild(e._conditionalColoringStyleTag),e._conditionalColoringStyleTag=null),e._conditionalColoringStyleTag=_(this._predefinedColorsStyles,e.getElement())},K.prototype.setPredefinedColors=function(e){if(null!=e&&"object"==typeof e){this._predefinedColors=e,this._predefinedColorsStyles=this._prepareStyles(e);for(var t=this._hosts,o=t.length,n=0;n<o;n++)this._injectPredefinedColors(t[n])}},K.getFilterBuilder=function(){return K._fb||(K._fb=new j),K._fb},K._fb=null,K.prototype._requestRowRefresh=function(){for(var e=this._hosts.length;--e>=0;)this._hosts[e].requestRowRefresh()},K.prototype.getColumnPainter=function(e){return this._getColumnOption(e,"painter")},K.prototype.applyColor=function(e,t,o){var n=this.getColumnPainter(e);if(n){o||(o={});var i={};i[this._getField(e)]=1,n.render(t,o,NaN,NaN,i)}},K.prototype._onSectionBinding=function(e){var t=e.dataRows;if(t){var o,n,i,r,l,s,a,u,d,c,p,f,h,_,g,m,v=e.section,C=v.getColumnCount(),y=e.fromRowIndex,b=e.toRowIndex,T=e.actualUpdate,w=e.dataSource,k=e.sender,D=T&&this._blinkingEnabled;D&&(p=K._mapInsertedRowId(e.events),this._compositeGrid&&(d=K._mergeUpdates(e)));var N,S=k._prevDataRows;for(n=y;n<b;++n)if(c=this._rowGetter(t[n])){for(l=null,D&&(this._realTimeGrid?(a=(s=c.ROW_DEF)?s.getRowId():"")&&!p[a]&&(l=s.getUpdates()):(u=d[n])&&(p[a=u.rid]||(l=u.changed))),a||(a=this._realTimeGrid?(s=c.ROW_DEF)?s.getRowId():"":w.getRowId(n)),N=S[a],g={},m=!1,o=0;o<C;++o)if((i=v.getCell(o,n,!1))&&(r=this.getColumnPainter(o))){if(_=!1,h=!1,(f=this._getColumnData(o)).blinking&&T){var x=f.blinkingField||this._getField(o),R=c[x];if(N){var F=N[x];null!=F&&l&&l[x]&&(h=!0,_=r.blinkCell(i,R,F,c,c))}h||r.verifyBlinking(i,c),g[x]=R,m=!0}f.coloringFields&&!_&&r.renderColoring(i,c)}m&&(S[a]=g),a=null}}},K.prototype._onColumnAdded=function(e){e.context&&this.setColumnColoring(e.colIndex,e.context,e.sender)},K.prototype._onColumnRemoved=function(e){var t=e.columnData;if(t){this._clearPainter(t);var o=e.colId;o&&(t.coloringFields&&this._removeFieldReferrer(o,"coloring"),t.blinkingField&&this._removeFieldReferrer(o,"blinking"));var n=t.field;if(n){var i=t.COL_DEF;if(!i||!i.isRealTimeField())for(var r=this.getColumnCount(),l=0;l<r;l++)(t=this._getColumnData(l)).coloringFields&&t.coloringFields[n]&&this.setConditionalColoring(l,null),t.blinkingField===n&&this.setColumnBlinking(l,null)}}},K.prototype._onThemeLoaded=function(){this._requestRowRefresh()},K.prototype._clearPainter=function(e){if(e){K._cleanUpPrevFields();var t=e.painter;if(t){if(this._isValidPainter(t))return t.dispose(),e.painter=null,!0;t.clearBlinking()}}return!1},K.prototype._setEffectiveStyles=function(e,t){for(var o=null,n=!1,i=!1,r=t?t.length:0,l=0;l<r;l++){var s=t[l];s.color&&(n=!0),s.backgroundColor&&(i=!0)}n&&i?o=z:n?o=H:i&&(o=M),e.setEffectiveStyles(o)},K._cleanUpPrevFields=function(){for(var e,t=this.getColumnCount(),o={},n=!1,i=0;i<t;i++)(e=this._getColumnData(i)).blinking&&(o[e.blinkingField]=n=!0);var r,l=this._hosts,s=l.length;if(n){var a,u,d,c;for(r=0;r<s;r++)for(d in u=l[r]._prevDataRows)for(c in a=u[d])o[c]||delete a[c]}else{for(r=0;r<s;r++)l[r]._prevDataRows={};K._stopCleanUpInterval()}},K.cleanUpPrevRows=function(){var e,t,o,n,i,r,l,s=this._hosts,a=s.length;for(o=0;o<a;o++)if(t=(e=s[o]).getDataSource())for(l=e._prevDataRows,i=Object.keys(l),n=0;n<i.length;n++)r=i[n],t.getRowData(r)||delete l[r]},K._startCleanUpInterval=function(){K._cleanUpTimer||(K._cleanUpTimer=setInterval(K.cleanUpPrevRows,18e5))},K._stopCleanUpInterval=function(){K._cleanUpTimer&&(clearInterval(K._cleanUpTimer),K._cleanUpTimer=0)},K.setThemeColors=F.setThemeColors,K.prototype.reloadThemeColors=function(){return F.reloadThemeColors().then(this._onThemeLoaded).catch(this._onThemeLoaded)};!function(e,t){if(e&&t&&t.prototype.getName){var o=t.prototype.getName().replace(/Plugin$/,"");if(o){var n=e.tr;n||(n=e.tr={});var i=n.grid;i||(i=n.grid={}),i[o+"Plugin"]=t,n[o+"Extension"]=t}}}(window,K)}]);