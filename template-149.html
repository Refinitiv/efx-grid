<h1 id="custom-sorting-in-atlas-blotter">Custom sorting in Atlas Blotter</h1>
<p>You can define custom sort logic in Atlas Blotter the same way as in Emerald Grid. The callback will also receive extra information about the column being sorted from the fourth parameter.</p>
<blockquote>
<p>Note: common data types such as <code>number</code>, <code>string</code>, and <code>Date</code> object can already be sorted by default sorting logic.</p>
</blockquote>
<pre><code class="language-js">var myCustomSorting = function(valA, valB, order, contextObj) {
    // contextObj provide more information about the column being sorted such as colIndex and field
    // ...
    return (valA - valB) * order;
};

var config = {
    // any other grid&#39;s options
    columns: [
        { name: &quot;Column 1&quot;, field: &quot;field1&quot;, sortLogic: myCustomSorting},
        { name: &quot;Column 2&quot;, field: &quot;field2&quot; },
    ],
}
</code></pre>
<p>You can enable <code>rowSorting</code> to use RowDefinition object for sorting comparison. This is useful when we want to compare data other than the data from the column being sorted.</p>
<pre><code class="language-js">var myCustomSorting = function(rowDefA, rowDefB, order, contextObj) {
    // Now we can access any data within a row from the RowDefinition object
    var valA = rowDefA.getData(contextObj.field);
    var valB = rowDefB.getData(contextObj.field);
    var extraInfoA = rowDefA.getData(&quot;some other field&quot;);
    var extraInfoB = rowDefB.getData(&quot;some other field&quot;);
    // ...
    return number;
};

var config = {
    // any other grid&#39;s options
    columns: [
        { name: &quot;Column 1&quot;, field: &quot;field1&quot;, rowSorting: true, sortLogic: myCustomSorting},
        { name: &quot;Column 2&quot;, field: &quot;field2&quot; },
    ],
}
</code></pre>
<blockquote>
<p>For <code>notRealTimeField</code> column, the default comparison method is row sorting. If you still want to sort by data instead of RowDefinition object, set <code>rowSorting</code> to false to override the default behavior.</p>
</blockquote>
<h2 id="atlas-blotter-example">Atlas Blotter example</h2>
<code-sandbox hash="b85cc37f"><pre><code class="language-css">atlas-blotter {
    height: 300px;
}
</code></pre>
<pre><code class="language-html">&lt;atlas-blotter&gt;&lt;/atlas-blotter&gt;
</code></pre>
<pre><code class="language-javascript">import &#39;./resources/extensions.js&#39;; // This line is only required for demo purpose. It is not relevant for your application.
import { halo } from &#39;./theme-loader.js&#39;; // This line is only required for demo purpose. It is not relevant for your application.
await halo(); // This line is only required for demo purpose. It is not relevant for your application.

/* ---------------------------------- Note ----------------------------------
  DataGenerator, Formatters and extensions are exposed to global scope
  in the bundle file to make it easier to create live examples.
  Importing formatters and extensions is still required in your application. 
  Please see the document for further information.
---------------------------------------------------------------------------*/
function sortTextAsNumber(valA, valB, order, contextObj) {
    var numA = +valA; // Convert string to number
    var numB = Number(valB); // Another way to convert string to number
    if(numA !== numA) { // Fastest way to check for NaN value
        if(isNaN(numB)) { // Traditional and slower way to check for NaN value
            return 0;
        } else {
            return 1; // Always put NaN value at the bottom
        }
    } else if(numB !== numB) {
        return -1; // Always put NaN value at the bottom
    }
    if(numA &lt; numB) {
        return -order;
    }
    if(numB &lt; numA) {
        return order;
    }
    
    return 0;
}

// Initial data set
var fields = [&quot;id&quot;, &quot;CF_LAST&quot;, &quot;PCTCHNG&quot;, &quot;ISODate&quot;, &quot;market&quot;];
var records = tr.DataGenerator.generateRecords(fields, {seed: 0, numRows: 8});
records[2][&quot;PCTCHNG&quot;] = &quot;N/A&quot;;
records[4][&quot;PCTCHNG&quot;] = &quot;Invalid data&quot;;
records[6][&quot;PCTCHNG&quot;] = &quot;Error&quot;;

var configObj = {
    sorting: {
        threeStatesSorting: true
    },
    columns: [
        {
            name: &quot;Column 1&quot;,
            field: fields[0],
            width: 70
        },
        {
            name: &quot;Default Sorting&quot;,
            field: fields[1],
            textAlign: &quot;right&quot;
        },
        {
            name: &quot;Custom Sorting&quot;,
            field: fields[2],
            sortingLogic: sortTextAsNumber
        },
        {
            name: &quot;Date&quot;,
            field: fields[3],
            width: 200
        },
        {
            name: &quot;Not Sortable&quot;,
            field: fields[4],
            sortable: false
        }
    ],
    extensions: [],
    staticDataRows: records
};

var blotter = document.getElementsByTagName(&quot;atlas-blotter&quot;)[0];
blotter.config = configObj;
</code></pre>
</code-sandbox><h1 id="custom-sorting-in-emerald-grid">Custom Sorting in Emerald Grid</h1>
<p>There are several cases where the data stored in each field in the data model is not a primitive type. Sorting this data requires a special approach with custom sorting logic.</p>
<blockquote>
<p>Note: comparison functions receive the same argument as <code>Array.prototype.sort</code>.</p>
</blockquote>
<p>To set custom sort logic for each column, do the following:</p>
<pre><code class="language-js">var config = {
    // any other grid&#39;s options
    columns: [
        { title: &quot;Column 1&quot;, field: &quot;field1&quot;, sortLogic: function(a, b, order) {/* Some compare function */} },
        { title: &quot;Column 2&quot;, field: &quot;field2&quot; },
    ],
}
</code></pre>
<p>The code below is another way of defining custom sort logic, but it is not recommended for usage. The API is kept for backward compatibility with legacy code.</p>
<blockquote>
<p>Note: this API is not available in Atlas Blotter.</p>
</blockquote>
<pre><code class="language-js">var config = {
    // any other grid&#39;s options
    sorting: {
        sortableColumns: true,
        sortLogic: {
            &quot;field1&quot;: function(a, b, order) {/* Some compare function */},
            &quot;field2&quot;: function(a, b, order) {/* Some compare function */}
        }
    }
}
</code></pre>
<p>Emerald Grid also allows you to specify the global custom sort logic using a <code>*</code> (wildcard) in the name.</p>
<blockquote>
<p>Note: this API is not available in Atlas Blotter.</p>
</blockquote>
<pre><code class="language-js">var config = {
    // any other grid&#39;s options
    sorting: {
        sortableColumns: true,
        sortLogic: {
            &quot;*&quot;: function(a, b, order) {/* Some compare function */},
        }
    }
}
</code></pre>
<h2 id="emerald-grid-example">Emerald Grid example</h2>
<code-sandbox hash="767101d3"><pre><code class="language-css">emerald-grid {
    height: 200px;
}
</code></pre>
<pre><code class="language-html">&lt;emerald-grid id=&quot;grid&quot;&gt;&lt;/emerald-grid&gt;
</code></pre>
<pre><code class="language-javascript">import &#39;./resources/extensions.js&#39;; // This line is only required for demo purpose. It is not relevant for your application.
import { halo } from &#39;./theme-loader.js&#39;; // This line is only required for demo purpose. It is not relevant for your application.
await halo(); // This line is only required for demo purpose. It is not relevant for your application.

/* ---------------------------------- Note ----------------------------------
  DataGenerator, Formatters and extensions are exposed to global scope
  in the bundle file to make it easier to create live examples.
  Importing formatters and extensions is still required in your application. 
  Please see the document for further information.
---------------------------------------------------------------------------*/
var dateFormatter = {
    render: function() {},
    bind: function(r, c, v, cell) {
        var str = v ? v.getFullYear()+&quot;/&quot;+(v.getMonth()+1)+&quot;/&quot;+v.getDate() : &quot;&quot;
        cell.setContent(str);
    }
}

var coordinateFormatter = {
    render: function() {},
    bind: function(r, c, v, cell) {
        var str = &quot;(&quot;+v.x+&quot;,&quot;+v.y+&quot;) -- distance = &quot; + Math.sqrt((v.x*v.x) + (v.y*v.y));
        cell.setContent(str);
    }
}

var dateSortLogic = function(a, b, order) {
    if (order === -1) { // Descending
        return b - a;
    } else
    if (order === 1) { // Ascending
        return a - b;
    } else {
        return 0;
    }
}

var arraySortLogic = function(a, b, order) {
    if (order === -1) { // Descending
        return b[0] - a[0];
    } else
    if (order === 1) { // Ascending
        return a[0] - b[0];
    } else {
        return 0;
    }
}

var coordinateSortLogic = function(a, b, order) {
    //Sort by the distance from (0,0)
    var distA = Math.sqrt((a.x*a.x) + (a.y*a.y));
    var distB = Math.sqrt((b.x*b.x) + (b.y*b.y));
    if (order === -1) { // Descending
        return distB - distA;
    } else
    if (order === 1) { // Ascending
        return distA - distB;
    } else {
        return 0;
    }
}

var configObj = {
    sorting: {
        sortableColumns: true,
    },
    columns: [
        {id: &quot;c1&quot;, title: &quot;Date&quot;, field: &quot;dateField&quot;, sortBy: &quot;dateField&quot;, formatter: dateFormatter, sortLogic: dateSortLogic},
        {id: &quot;c2&quot;, title: &quot;Array Average&quot;, field: &quot;arrayField&quot;, sortBy: &quot;arrayField&quot;, sortLogic: arraySortLogic},
        {id: &quot;c3&quot;, title: &quot;Coordinate&quot;, field: &quot;objectField&quot;, sortBy: &quot;objectField&quot;, formatter: coordinateFormatter, sortLogic: coordinateSortLogic},
    ],
    dataModel: {
        fields: [&quot;dateField&quot;, &quot;arrayField&quot;, &quot;objectField&quot;],
        format: &quot;array&quot;,
        data: [
            [new Date(2015,2,20), [2,3,5],   {x:10, y: 10}],
            [new Date(2015,2,23), [5,8,9],   {x:13, y: 40}],
            [new Date(2015,2,10), [1,12,5],  {x:15, y: 50}],
            [new Date(2015,2,2),  [10,55,9], {x:11, y: 10}],
            [new Date(2015,2,8),  [44,10,2], {x:14, y: 70}],
            [new Date(2015,2,14), [68,1,10], {x:17, y: 10}],
            [new Date(2015,2,16), [22,33,55],{x:19, y: 30}]
        ]
    }
};

var grid = document.getElementById(&quot;grid&quot;);
grid.config = configObj;
</code></pre>
</code-sandbox>